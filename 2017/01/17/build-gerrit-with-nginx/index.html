
 <!DOCTYPE HTML>
<html lang="zh-CN：">
<head>
  <meta charset="UTF-8">
  
    <title>【Gerrit】Linux + Gerrit + Nginx + gitweb安装全过程 | KaKa&#39;s blog</title>
    <meta name="viewport" content="width=device-width, initial-scale=1,user-scalable=no">
    
    <meta name="author" content="Michael Lee">
    

    
    <meta name="description" content="最近公司的项目打算启用gerrit做为代码审核的工具，最近3天彻底研究了下gerrit的安装配置过程，这里做个记录，期间很多细节都一一记录下来，以便之后有同学需要用到。这篇博文先介绍下gerrit的安装过程，然后之后还准备写一篇文章，介绍如何利用gerrit和sourceTree进行协同工作，换句话说，就是gerrit的详细工作流程。">
<meta property="og:type" content="article">
<meta property="og:title" content="【Gerrit】Linux + Gerrit + Nginx + gitweb安装全过程">
<meta property="og:url" content="http://lipeng1667.github.io/2017/01/17/build-gerrit-with-nginx/index.html">
<meta property="og:site_name" content="KaKa's blog">
<meta property="og:description" content="最近公司的项目打算启用gerrit做为代码审核的工具，最近3天彻底研究了下gerrit的安装配置过程，这里做个记录，期间很多细节都一一记录下来，以便之后有同学需要用到。这篇博文先介绍下gerrit的安装过程，然后之后还准备写一篇文章，介绍如何利用gerrit和sourceTree进行协同工作，换句话说，就是gerrit的详细工作流程。">
<meta property="og:image" content="http://img.cdn.microwu.com/20170117/0.png">
<meta property="og:image" content="http://img.cdn.microwu.com/20170117/3.png">
<meta property="og:image" content="http://img.cdn.microwu.com/20170117/1.png">
<meta property="og:image" content="http://img.cdn.microwu.com/20170117/4.png">
<meta property="og:image" content="http://img.cdn.microwu.com/20170117/2.png">
<meta property="og:image" content="http://img.cdn.microwu.com/20170117/5.png">
<meta property="og:image" content="http://img.cdn.microwu.com/20170118/6.png">
<meta property="og:image" content="http://img.cdn.microwu.com/20170118/0.png">
<meta property="og:image" content="http://img.cdn.microwu.com/20170118/1.png">
<meta property="og:updated_time" content="2019-01-02T11:36:27.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="【Gerrit】Linux + Gerrit + Nginx + gitweb安装全过程">
<meta name="twitter:description" content="最近公司的项目打算启用gerrit做为代码审核的工具，最近3天彻底研究了下gerrit的安装配置过程，这里做个记录，期间很多细节都一一记录下来，以便之后有同学需要用到。这篇博文先介绍下gerrit的安装过程，然后之后还准备写一篇文章，介绍如何利用gerrit和sourceTree进行协同工作，换句话说，就是gerrit的详细工作流程。">
<meta name="twitter:image" content="http://img.cdn.microwu.com/20170117/0.png">
<meta name="twitter:creator" content="@Leepeng1667">

    
    <link rel="alternative" href="/atom.xml" title="KaKa&#39;s blog" type="application/atom+xml">
    
    
    <link rel="icon" href="/img/favicon.ico">
    
    
    <link rel="apple-touch-icon" href="/img/jacman.jpg">
    <link rel="apple-touch-icon-precomposed" href="/img/jacman.jpg">
    
    <link rel="stylesheet" href="/css/style.css">
</head>

  <body>
    <header>
      
<div>
		
			<div id="imglogo">
				<a href="/"><img src="/img/logo_.png" alt="KaKa&#39;s blog" title="KaKa&#39;s blog"/></a>
			</div>
			
			<div id="textlogo">
				<h1 class="site-name"><a href="/" title="KaKa&#39;s blog">KaKa&#39;s blog</a></h1>
				<h2 class="blog-motto">It is more important to know where you are going than to get there quickly. Do not mistake activity for achievement.</h2>
			</div>
			<div class="navbar"><a class="navbutton navmobile" href="#" title="Menu">
			</a></div>
			<nav class="animated">
				<ul>
					<ul>
					 
						<li><a href="/">Home</a></li>
					
						<li><a href="/archives">Archives</a></li>
					
					<li>
 					
					<form class="search" action="//google.com/search" method="get" accept-charset="utf-8">
						<label>Search</label>
						<input type="search" id="search" name="q" autocomplete="off" maxlength="20" placeholder="Search" />
						<input type="hidden" name="q" value="site:lipeng1667.github.io">
					</form>
					
					</li>
				</ul>
			</nav>			
</div>
    </header>
    <div id="container">
      <div id="main" class="post" itemscope itemprop="blogPost">
  
	<article itemprop="articleBody"> 
		<header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2017/01/17/build-gerrit-with-nginx/" title="【Gerrit】Linux + Gerrit + Nginx + gitweb安装全过程" itemprop="url">【Gerrit】Linux + Gerrit + Nginx + gitweb安装全过程</a>
  </h1>
  <p class="article-author">BY
       
		<a href="/about" title="Michael Lee" target="_blank" itemprop="author">Michael Lee</a>
		
  <p class="article-time">
    <time datetime="2017-01-17T06:43:49.000Z" itemprop="datePublished"> Published 2017-01-17</time>
  </p>
  
  <p class="page-count">
    阅读数:<span id="busuanzi_value_page_pv"></span>
  </p>

</header>

	<div class="article-content">
		
		<div id="toc" class="toc-article">
			<strong class="toc-title">Contents</strong>
		
			<ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#开发环境"><span class="toc-number">1.</span> <span class="toc-text">开发环境</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#安装gerrit"><span class="toc-number">2.</span> <span class="toc-text">安装gerrit</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#下载gerrit安装包"><span class="toc-number">2.1.</span> <span class="toc-text">下载gerrit安装包</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#新建gerrit专用用户"><span class="toc-number">2.2.</span> <span class="toc-text">新建gerrit专用用户</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#安装gerrit-1"><span class="toc-number">2.3.</span> <span class="toc-text">安装gerrit</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#启动gerrit"><span class="toc-number">2.4.</span> <span class="toc-text">启动gerrit</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Nginx"><span class="toc-number">3.</span> <span class="toc-text">Nginx</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#nginx默认配置"><span class="toc-number">3.1.</span> <span class="toc-text">nginx默认配置</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#gerrit-conf配置"><span class="toc-number">3.2.</span> <span class="toc-text">gerrit.conf配置</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#重启nginx"><span class="toc-number">3.3.</span> <span class="toc-text">重启nginx</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#登录认证文件"><span class="toc-number">3.4.</span> <span class="toc-text">登录认证文件</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#修改gerrit配置"><span class="toc-number">4.</span> <span class="toc-text">修改gerrit配置</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#重启gerrit"><span class="toc-number">4.1.</span> <span class="toc-text">重启gerrit</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#gitweb-可选"><span class="toc-number">5.</span> <span class="toc-text">gitweb(可选)</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#安装gitweb"><span class="toc-number">5.1.</span> <span class="toc-text">安装gitweb</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#修改gitweb配置文件"><span class="toc-number">5.2.</span> <span class="toc-text">修改gitweb配置文件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#修改Apache配置文件"><span class="toc-number">5.3.</span> <span class="toc-text">修改Apache配置文件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#修改gerrit配置-1"><span class="toc-number">5.4.</span> <span class="toc-text">修改gerrit配置</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#补充内容"><span class="toc-number">6.</span> <span class="toc-text">补充内容</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#卸载Gerrit"><span class="toc-number">6.1.</span> <span class="toc-text">卸载Gerrit</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#删除git工程"><span class="toc-number">6.2.</span> <span class="toc-text">删除git工程</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#退出gerrit网页"><span class="toc-number">6.3.</span> <span class="toc-text">退出gerrit网页</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#参考文献："><span class="toc-number">6.4.</span> <span class="toc-text">参考文献：</span></a></li></ol></li></ol>
		
		</div>
		
		<p>最近公司的项目打算启用gerrit做为代码审核的工具，最近3天彻底研究了下gerrit的安装配置过程，这里做个记录，期间很多细节都一一记录下来，以便之后有同学需要用到。<br>这篇博文先介绍下gerrit的安装过程，然后之后还准备写一篇文章，介绍如何利用gerrit和sourceTree进行协同工作，换句话说，就是gerrit的详细工作流程。</p>
<a id="more"></a>
<h1 id="开发环境"><a href="#开发环境" class="headerlink" title="开发环境"></a>开发环境</h1><p>先记录下我的开发环境以及要正确安装gerrit需要用到的工具：</p>
<ul>
<li>Redhat(CentOS) 6.5</li>
<li><strong>Java 1.7.0 (至少1.6以上)</strong></li>
<li>git 1.7,1</li>
<li>Nginx 1.10.2</li>
<li>Apache 2.2.15</li>
</ul>
<p>几点说明：</p>
<ol>
<li><p>关于操作系统<br>Redhat和CentOS用的是同样的内核，我这里是6.5版本的内核；其他linux系统上安装过程照猫画虎应该也差不多，只不过可能比如Java或者Nginx等工具的安装方式有所差别。<br>为了方便后面文章的讲解，我们这里假设gerrit服务器的ip地址是<code>192.168.1.100</code></p>
</li>
<li><p>关于Java环境<br>在终端中输入 <code>java -version</code> 务必确保你的java环境正确安装了；因为整个gerrit的安装是依赖于Java的，另外最好确保Java版本在<em>1.6</em>以上吧，虽然我没有验证过低版本的Java是不是没问题，但是高一点的版本保险一点。</p>
</li>
<li><p>Web服务器<br>网上很多教程有讲到gerrit+apache安装过程的，我这里是用nginx。先来说说为什么一定要用apache或者nginx，是的就是为了<code>反向代理</code>。<br>Gerrit有两种工作方式，我们要采用<code>http</code>的工作方式，也就是代码审核人员，可以直接通过Web页面对提交的代码进行评审以及后续的操作。<br>然后Gerrit要求不能直接请求其端口，必须要使用反向代理才能正确登录。而我们知道Nginx的成功正在于其高效、轻量级以及<strong>反向代理</strong>，虽然Apache也有反向代理的功能，但是如果你在安装Apache时没有开启，后续的开启过程要相对复杂一点，而Nginx就简单的多了。<br>不过即便我们使用Nginx做为web页面引擎，仍然需要安装Apache，因为我们需要用到apache的一个工具来创建验证密码文件。这个后面我们会看到具体用法。</p>
</li>
<li><p>数据库<br>我们使用gerrit自带的H2数据库。网上也有其他数据库的安装教程，我这里想说的是，H2就够用，而且，我们不推荐直接对数据库进行操作，所有的操作，都可以通过命令行的方式完成，所以，尽量简单我们就使用自带的默认的数据库好了。</p>
</li>
</ol>
<p>所以，请务必确保以上几个工具正确安装。<br>在RedHat或者CentOS上可以通过<code>yum</code>工具来安装，如果yum的源打不开，可以去网上搜一下替换yum源的方法。</p>
<h1 id="安装gerrit"><a href="#安装gerrit" class="headerlink" title="安装gerrit"></a>安装gerrit</h1><h2 id="下载gerrit安装包"><a href="#下载gerrit安装包" class="headerlink" title="下载gerrit安装包"></a>下载gerrit安装包</h2><p>gerrit的下载地址:<br><a href="https://www.gerritcodereview.com/releases/README.md" target="_blank" rel="external">https://www.gerritcodereview.com/releases/README.md</a><br>我使用的gerrit版本是<em>2.13.4</em>。 下载完成之后会发现是一个<code>war</code>的包，所以我们的Java环境一定要安装正确。</p>
<h2 id="新建gerrit专用用户"><a href="#新建gerrit专用用户" class="headerlink" title="新建gerrit专用用户"></a>新建gerrit专用用户</h2><p>新建一个用户用来专门管理gerrit相关的内容。<br>在root用户（或者使用<code>sudo</code>命令）下面输入下面的命令:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ adduser gerrit</span><br><span class="line">$ su gerrit</span><br></pre></td></tr></table></figure>
<p>建好用户以后，我们可以把之前下载好的gerrit安装包(gerrit-2.13.4.war)拷贝到<code>/home/gerrit/</code>目录下，一会方便gerrit用户来安装。</p>
<h2 id="安装gerrit-1"><a href="#安装gerrit-1" class="headerlink" title="安装gerrit"></a>安装gerrit</h2><p>在gerrit用户的目录(/home/gerrit/)下面，执行下面的命令：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ java -jar gerrit-2.13.4.war init <span class="_">-d</span> ~/gerrit_site</span><br></pre></td></tr></table></figure>
<p>这个命令的意思是执行安装gerrit，会在当前目录下新建一个文件夹<code>gerrit_site</code>用来作为gerrit的根目录，在这个目录中，会安装git仓库，以及gerrit的web页面，还有gerrit的bin，etc等文件夹。<br>然后就开始安装过程了，安装的过程会询问很多问题，有一些判断性的问题会用<code>[y/N]</code>这样的形式，大写的字母表示默认，我们直接敲回车就表示采用默认的安装选项。</p>
<font color="red">注意：</font>

<ul>
<li>我们安装的时候，可以只在<code>Authentication method</code>时输入<code>http</code>，其他全部回车用默认值，因为其他配置我们待会可以通过<code>etc/gerrit.config</code>文件进行修改</li>
<li>期间可能会下载两个文件，这两个文件虽然都很小(不到3M)，但是可能是因为GFW的原因，下载速度很慢。你可以到<code>/lib</code>文件夹下面查看他们是不是已经下载完了，或者你手动把那两个文件下载完之后，scp到<code>/lib</code>下面。<br>如果你发现已经下完了，但是安装过程卡主了，没有关系，直接<code>ctrl+c</code>然后重新安装就可以了。</li>
</ul>
<p>下面我就把整个安装过程全部贴出来，加上一些注释，好让大家看清楚都安装了什么：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line">*** Gerrit Code Review 2.13.4  </span><br><span class="line">***</span><br><span class="line"></span><br><span class="line">## git 代码仓库的位置, 默认会在之前敲的init -d 目录下新建一个git文件夹</span><br><span class="line">## 我们回车表示默认地址</span><br><span class="line">*** Git Repositories  </span><br><span class="line">***  </span><br><span class="line"></span><br><span class="line">Location of Git repositories   [git]:   </span><br><span class="line"></span><br><span class="line">## 数据库类型，我们直接回车表示默认的h2</span><br><span class="line">*** SQL Database  </span><br><span class="line">***  </span><br><span class="line"></span><br><span class="line">Database server type           [h2]:   </span><br><span class="line"></span><br><span class="line">## 用户认证方式，注意！！！！！这里一定要手动输入 http， 其他的就直接回车</span><br><span class="line">*** User Authentication  </span><br><span class="line">***  </span><br><span class="line"></span><br><span class="line">Authentication method          [OPENID/?]: http  </span><br><span class="line">Get username from custom HTTP header [y/N]?  </span><br><span class="line">SSO logout URL                 :  </span><br><span class="line"></span><br><span class="line">## 发送email的配置，这里我们全部回车使用默认，之后通过配置文件进行修改  </span><br><span class="line">*** Email Delivery  </span><br><span class="line">***  </span><br><span class="line"></span><br><span class="line">SMTP server hostname           [localhost]:  </span><br><span class="line">SMTP server port               [(default)]:  </span><br><span class="line">SMTP encryption                [NONE/?]:  </span><br><span class="line">SMTP username                  :  </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">## 剩下的全部回车就好了，全部安装成默认的配置</span><br><span class="line">*** Container Process  </span><br><span class="line">***  </span><br><span class="line"></span><br><span class="line">Run as                         [gerrit]:  </span><br><span class="line">Java runtime                   [/usr/lib/jvm/java-7-openjdk-amd64/jre]:  </span><br><span class="line">Copy gerrit-2.13.4.war to /home/gerrit/review/bin/gerrit.war [Y/n]?  </span><br><span class="line">Copying gerrit-2.13.4.war to /home/gerrit/review/bin/gerrit.war  </span><br><span class="line"></span><br><span class="line">*** SSH Daemon  </span><br><span class="line">***  </span><br><span class="line"></span><br><span class="line">Listen on address              [*]:  </span><br><span class="line">Listen on port                 [29418]:  </span><br><span class="line"></span><br><span class="line">## 这里下载可能会失败，按照我之前说过的方法重新试一遍应该就ok了  </span><br><span class="line">Gerrit Code Review is not shipped with Bouncy Castle Crypto SSL v151  </span><br><span class="line">  If available, Gerrit can take advantage of features  </span><br><span class="line">  in the library, but will also function without it.  </span><br><span class="line">Download and install it now [Y/n]?  </span><br><span class="line">Downloading http://www.bouncycastle.org/download/bcpkix-jdk15on-151.jar ...  </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">## http的反向代理，我们这里先不要设置，一路回车，尽快完成安装</span><br><span class="line">*** HTTP Daemon  </span><br><span class="line">***  </span><br><span class="line">Behind reverse proxy           [y/N]?   </span><br><span class="line">Proxy uses SSL (https://)      [y/N]?  </span><br><span class="line">Subdirectory on proxy server   [/]:  </span><br><span class="line">Listen on address              [*]:  </span><br><span class="line">Listen on port                 [8080]:</span><br><span class="line"></span><br><span class="line">// 插件，默认都是不安装的</span><br><span class="line">*** Plugins  </span><br><span class="line">***  </span><br><span class="line"></span><br><span class="line">Installing plugins.  </span><br><span class="line">Install plugin download-commands version v2.11 [y/N]?  </span><br><span class="line">Install plugin reviewnotes version v2.11 [y/N]?  </span><br><span class="line">Install plugin singleusergroup version v2.11 [y/N]?  </span><br><span class="line">Install plugin replication version v2.11 [y/N]?  </span><br><span class="line">Install plugin commit-message-length-validator version v2.11 [y/N]?  </span><br><span class="line">Initializing plugins.  </span><br><span class="line">No plugins found with init steps.  </span><br><span class="line"></span><br><span class="line">Initialized /home/gerrit_site</span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>其实安装过程真的很简单，只是在<code>Authentication method</code>方式时输入<code>http</code>其他的一路回车下去就好了。</p>
<h2 id="启动gerrit"><a href="#启动gerrit" class="headerlink" title="启动gerrit"></a>启动gerrit</h2><p>安装完成之后，gerrit会自动启动，而且会开始监听两个端口:</p>
<ul>
<li>29418: 默认的ssh端口；</li>
<li>8080:  gerrit默认的web页面端口。</li>
</ul>
<p>我们可以通过下面命令查看：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ netstat -ltpn | grep -i gerrit</span><br><span class="line"></span><br><span class="line">tcp        0      0 :::29418               :::*              LISTEN      49513/GerritCodeRev</span><br><span class="line">tcp        0      0 :::8080                :::*              LISTEN      49513/GerritCodeRev</span><br></pre></td></tr></table></figure>
<h1 id="Nginx"><a href="#Nginx" class="headerlink" title="Nginx"></a>Nginx</h1><p>接下来就该Nginx上场了。</p>
<p>在没有配置nginx反向之前，我们直接访问<code>192.168.1.100:8080/login</code>(我们之前假设gerrit服务器的ip地址是192.168.1.100)，会得到一个错误页面，这个页面对于初次使用http方式的gerrit用户可能会让你感到非常。。。绝望，笔者至少看到这个页面不下10多次。。。<br>就是这样图片：</p>
<p align="center"><br>  <img src="http://img.cdn.microwu.com/20170117/0.png" width="800"><br></p>

<p>下面我们就来看一下nginx需要怎样配置吧。</p>
<h2 id="nginx默认配置"><a href="#nginx默认配置" class="headerlink" title="nginx默认配置"></a>nginx默认配置</h2><p>我们首先看一看nginx的默认配置。<br>注意，你的nginx应该是用root账户安装的，否则可能出现权限问题。我们需要从之前的gerrit用户退出来。<br>在root用户下面，输入下面的命令：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">cd</span> /etc/nginx/conf.d</span><br><span class="line">$ ls <span class="_">-l</span></span><br></pre></td></tr></table></figure>
<p>默认的nginx只有一个default.conf文件，是nginx的默认配置文件，我们这里需要新建一个专门用来处理gerrit请求的配置文件，先来看一下我的目录吧：</p>
<p align="center"><br>  <img src="http://img.cdn.microwu.com/20170117/3.png" width="500"><br></p>

<p>我这里新建了一个<code>gerrit.conf</code>文件，用来处理gerrit的反向代理。待会我们来看里面需要配置些什么，我们先来研究下nginx默认的配置文件， <code>default.conf</code>吧。</p>
<p align="center"><br>  <img src="http://img.cdn.microwu.com/20170117/1.png" width="500"><br></p>

<p>上面就是默认的配置，看到这里我把端口默认的监听端口设置成了82， 因为80分配给了apache；<br>然后日志文件的路径在<code>/var/log/nginx/</code>目录下，如果后面登录认证的失败的时候，我们可以在这个目录下面查找日志文件，分析失败的原因。<br>nginx路径在<code>/usr/share/nginx/</code>路径下，如果我们进到该目录下，查看其下面的index.html文件，就会发现他就是我们在<code>192.168.1.100:82</code>页面中看到的关于nginx的介绍的页面。</p>
<p align="center"><br>  <img src="http://img.cdn.microwu.com/20170117/4.png" width="500"><br></p>

<p>之后还有一些注释掉的关于php的配置部分，这里不做多余的介绍。</p>
<h2 id="gerrit-conf配置"><a href="#gerrit-conf配置" class="headerlink" title="gerrit.conf配置"></a>gerrit.conf配置</h2><p>重点来看下我们的<code>gerrit.conf</code>文件如何设置。<br>我们用<code>vim gerrit.conf</code>创建这个文件，然后输入下面的内容：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">server &#123;</span><br><span class="line">     listen *:81;</span><br><span class="line">     server_name gerrit.microwu.com;</span><br><span class="line">     allow   all;</span><br><span class="line">     deny    all;</span><br><span class="line"></span><br><span class="line">     auth_basic &quot;Welcomme to Gerrit Code Review Site!&quot;;</span><br><span class="line">     auth_basic_user_file /home/gerrit/gerrit.password;</span><br><span class="line"></span><br><span class="line">     location / &#123;</span><br><span class="line">        proxy_pass  http://127.0.0.1:8080;</span><br><span class="line">        proxy_set_header X-Forwarded-For $remote_addr;</span><br><span class="line">        proxy_set_header Host $host;</span><br><span class="line">     &#125;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>
<p>最终是这样的：</p>
<p align="center"><br>  <img src="http://img.cdn.microwu.com/20170117/2.png" width="400"><br></p>

<p>我们来详细解释几个重点：</p>
<ul>
<li>我们监听<code>81</code>端口，原因和前面一样，80端口被apache占用了，当然你还可以设置成其他没有被占用的端口</li>
<li><p>auth_basic 是用于登录时弹出验证登录对话框，我盗一张图来说明一下</p>
  <p align="center"><br>      <img src="http://img.cdn.microwu.com/20170117/5.png" width="300"><br>  </p>

<p>  图片中 <em>服务器提示：</em> 后面的文字，就是我们在配置中当前选项的内容</p>
</li>
<li><p>auth_basic_user_file 是我们输入用户名和密码之后要去验证是否匹配的文件，看到路径是放在我们的gerrit用户目录下面；这个详细的内容我们一会再来说。</p>
</li>
<li>location 部分指的的是当用户访问到<code>192.168.1.100:81</code>时，要指向的内容，这里面的proxy_pass 字段表示要做的反向代理，指向的是8080，还记得8080端口是谁在用么？对的，就是我们之前新建好的gerrit的web监听端口，也就是说，当用户访问81端口时，nginx直接把这个请求代理到8080端口上去了，这个就是所谓的<code>反向代理</code>。</li>
</ul>
<h2 id="重启nginx"><a href="#重启nginx" class="headerlink" title="重启nginx"></a>重启nginx</h2><p>配置好了之后，我们需要重启nginx</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ service nginx restart</span><br></pre></td></tr></table></figure>
<p>然后我们去访问<code>http://192.168.1.100:81</code>页面，就能看到和上图一样的登录认证界面了。</p>
<h2 id="登录认证文件"><a href="#登录认证文件" class="headerlink" title="登录认证文件"></a>登录认证文件</h2><p>那登录认证有了，我们怎么登录呢？？就需要前面的<code>auth_basic_user_file</code>文件了。</p>
<p>这里我们需要用apach的 <code>htpasswd</code>工具来新建这个文件，这也是为什么我们虽然不用到apache的反向代理，仍然需要apache的原因。</p>
<p>我们通过下面的命令来在<code>/home/gerrit/</code>路径下创建认证文件</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ htpasswd -c /home/gerrit/gerrit.password admin</span><br></pre></td></tr></table></figure>
<p>这个命令的详细解释：</p>
<ul>
<li>-c表示create，也就是新建的意思</li>
<li>接下来跟上文件要创建的目录以及文件名，我们直接用绝对路径，表示将在<code>/home/gerrit</code>目录下新建一个<code>gerrit.password</code>文件</li>
<li>最后的admin表示要写入的用户名</li>
</ul>
<p>接下来你需要在命令行中连续输入两次密码，我们就为admin用户设置好了密码，可以通过vim来查看下这个密码文件，会发现里面是经过加密的。</p>
<p>如果我们想新建别的用户，或者修改某个用户的密码，只需要把<code>-c</code>改成<code>-m</code>就好了，如果还是用<code>-c</code>并且路径不变的话，就会覆盖掉原来的文件。<br>例如：我们想要新增一个用户，master，允许其通过页面登录，只需要执行下面的命令就好了</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ htpasswd -m /home/gerrit/gerrit.password master</span><br></pre></td></tr></table></figure>
<p>同样的输入两遍密码，就设置好了master用户的登录密码了。</p>
<font color="red"><strong>注意</strong>：</font>

<p>如果你是在root用户下输入上面的命令 创建了<code>gerrit.password</code>文件到<code>/home/gerrit/</code>目录中，你会发现在登录的时候永远登录不成功，永远会得到服务器500的错误页面。原因是<code>/homt/gerrit/</code>文件夹的权限问题。</p>
<p>我们知道，<code>/home/gerrit/</code>是我们之前新建的gerrit用户的，那么这个文件夹的权限是700，也就是只允许gerrit用户访问，其他组的用户是访问不了的，虽然这个文件的权限拥有root用户的所有权限，但是因为它放在700权限的文件夹下面，所以同样其他用户是访问不到的。</p>
<p>这个问题之前纠缠了我好久，通过nginx的日志可以清楚的看到访问拒绝的错误。</p>
<p>所以，我们需要通过下面的命令，来改变gerrit目录的权限</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ chmod 755 /home/gerrit</span><br></pre></td></tr></table></figure>
<p>这样，当前目录权限就变成了<code>drwxr-xr-x</code>，也就是其他组的用户也拥有了读取和执行的权利。</p>
<h1 id="修改gerrit配置"><a href="#修改gerrit配置" class="headerlink" title="修改gerrit配置"></a>修改gerrit配置</h1><p>好了，配置好了nginx，我们接下来修改下gerrit的配置，我们要做下面几个事情：</p>
<ul>
<li>配置SMTP邮件发送</li>
<li>配置反向代理</li>
</ul>
<p>先来看一下我最终成品图，红框里面的东西是需要我们特别注意的：</p>
<p align="center"><br>      <img src="http://img.cdn.microwu.com/20170118/6.png" width="600"><br></p>

<ol>
<li>canonicalWebUrl 就是gerrit的主页地址。开篇时，我们假设gerrit服务器的ip地址是<em>192.168.1.100</em>，这里我们就需要设置成<code>http://192.168.1.100:8080</code></li>
<li>auth的类型一定要是http，这是我们在安装的时候<strong>唯一</strong>需要手动设置的地方</li>
<li><p>sendemail选项就是我们的邮件发送设置，如果你的gerrit服务器上没有搭建邮件服务器，那你可以用smtp发件代理，我这里去我们公司的邮箱注册了一个gerrit专用邮箱<code>gerrit@microwu.com</code>，我们公司使用的是阿里云的服务，所以smtp服务器地址是<code>smtp.mxhichina.com</code>，端口使用<code>465</code>，因为使用的是<code>SSL</code>认证，然后<code>smtpPass</code>填写上之前专用邮箱的密码。</p>
<p> sendemail有什么作用呢？</p>
<ul>
<li>当有新的允许登录web页面的成员需要修改自己的邮箱时，点击注册邮箱，我们这个专用邮箱就会向该成员申请的邮箱中发送一封确认邮件。</li>
<li><p>位于Administrator组中的用户，设置了想要watch的项目之后，所有和该项目相关的事件，都能收到一封邮件提醒，发送来自于这个专有邮箱</p>
<p>具体的细节我们在下一篇文章中再详细介绍</p>
</li>
</ul>
</li>
<li>sshd就是ssh监听的端口，这个我们在安装gerrit时采用的是默认的配置，也就是<code>29418</code>这个端口</li>
<li>httpd表示反向监听的端口，这里注意要修改成<code>proxy-http://*:8080/</code>，默认值是没有proxy的</li>
</ol>
<h2 id="重启gerrit"><a href="#重启gerrit" class="headerlink" title="重启gerrit"></a>重启gerrit</h2><p>完成上面的配置之后，我们重启一下gerrit</p>
<p>gerrit的可执行文件位于<code>/home/gerrit/gerrit_site/bin</code>目录下，我们直接执行</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ /home/gerrit/gerrit_site/bin/gerrit.sh restart</span><br></pre></td></tr></table></figure>
<p>这样，gerrit就会重新启动，并且加载我们刚才修改的配置。</p>
<p>重启完成之后，我们可以在浏览器中输入<code>192.168.1.100:81</code>看看是不是可以弹出输入用户名和密码的对话框(如果没有，请检查你的Nginx配置)；然后输入正确的用户名(我们创建的密码文件用户是admin)和密码，如果你能登录到这个页面，就表示你的gerrit已经成功配置好了！</p>
<p align="center"><br>      <img src="http://img.cdn.microwu.com/20170118/0.png" width="800"><br></p>

<p>需要注意的是，gerrit配置了之后，第一个登录成功的用户，自动成为管理员，gerrit会给他分配一个id，<code>1000000</code>，之后登录的成员会依次自增1，初始时 Full Name 和 Email Address字段都是空的。</p>
<p>关于Gerrit的安装和配置Nginx实现反向代理的内容都介绍完了，关于如何使用Gerrit以及Gerrit的工作原理和流程，我们在下一个章节再介绍。</p>
<h1 id="gitweb-可选"><a href="#gitweb-可选" class="headerlink" title="gitweb(可选)"></a>gitweb(可选)</h1><p>gitweb可以让你的git工程变得更加方便阅读，它相当于网页版的sourceTree或者其他git可视化工具，让你清楚地看到每一次改变的详情。<br>配置了gitweb之后，可以在gerrit的主页project中增加一个gitweb的连接。</p>
<p><font color="red">说明：</font>gitweb部分的内容是可选的，不配置gitweb一样可以正常使用gerrit。<br>下面简要介绍一下集成gitweb的步骤。</p>
<h2 id="安装gitweb"><a href="#安装gitweb" class="headerlink" title="安装gitweb"></a>安装gitweb</h2><ul>
<li>ubuntu: <code>apt-get install gitweb</code></li>
<li>redhat/centOS: <code>yum install gitweb</code></li>
</ul>
<p>默认gitweb是安装到apache目录中的，也就是<code>/var/www/</code>目录下会有一个<code>git</code>文件夹，专门用来显示gitweb页面</p>
<h2 id="修改gitweb配置文件"><a href="#修改gitweb配置文件" class="headerlink" title="修改gitweb配置文件"></a>修改gitweb配置文件</h2><p>gitweb的配置文件地址在：<code>/etc/gitweb.conf</code><br>默认的文件中所有的内容应该都被注释掉了，我们直接在最后面执行git仓库的位置：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$projectroot = &quot;/home/gerrit/gerrit_site/git&quot;</span><br></pre></td></tr></table></figure>
<p><font color="red">注：</font>可能你的gerrit位置和我的不一样。如果你按照我这篇文章的教程安装gerrit，则和上面代码一样，只要正确指向所有git仓库的根目录就好了。</p>
<h2 id="修改Apache配置文件"><a href="#修改Apache配置文件" class="headerlink" title="修改Apache配置文件"></a>修改Apache配置文件</h2><p>这里先说明一下，gitweb同样可以通过nginx来代理，不过因为默认是在apache目录下，这里我就只介绍下apache的配置，nginx的配置请自行google。</p>
<p>同nginx一样，apache的配置目录(<code>/etc/httpd/</code>)下也有两个文件夹，<code>conf</code>和<code>conf.d</code>，前面是默认的所有配置，后面是可以自定义的配置。</p>
<p>我们可以选择修改默认配置(<code>/etc/httpd/conf/httpd.conf</code>)或者新建一个配置，然后在配置文件中加入下面的代码：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">#</span><br><span class="line"># gitweb</span><br><span class="line">#</span><br><span class="line">Alias /gitweb &quot;/var/www/git&quot;</span><br><span class="line">&lt;Directory &quot;/var/www/git&quot;&gt;</span><br><span class="line">    Options FollowSymLinks +ExecCGI</span><br><span class="line">    AddHandler cgi-script .cgi</span><br><span class="line">    DirectoryIndex index.cgi gitweb.cgi</span><br><span class="line">    Order allow,deny</span><br><span class="line">    Allow from all</span><br><span class="line">&lt;/Directory&gt;</span><br></pre></td></tr></table></figure>
<p>接下来重启一下apache服务器(<code>service httpd restart</code>)，你就可以在<code>http://192.168.1.100/gitweb</code>页面中看到你的git项目了。</p>
<h2 id="修改gerrit配置-1"><a href="#修改gerrit配置-1" class="headerlink" title="修改gerrit配置"></a>修改gerrit配置</h2><p>修改<code>/home/gerrit/gerrit_site/etc/gerrit.conf</code>文件，添加如下内容：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[gitweb]</span><br><span class="line">        type = gitweb</span><br><span class="line">        cgi = /var/www/git/gitweb.cgi</span><br></pre></td></tr></table></figure>
<p>然后重启一下gerrit服务(<code>/home/gerrit/gerrit_site/bin/gerrit.sh restart</code>)，并重新登录web页面，就可以了！！</p>
<h1 id="补充内容"><a href="#补充内容" class="headerlink" title="补充内容"></a>补充内容</h1><h2 id="卸载Gerrit"><a href="#卸载Gerrit" class="headerlink" title="卸载Gerrit"></a>卸载Gerrit</h2><p>如果你的安装过程出错了，或者觉得安装的不够好，比如文件位置什么的，你可以重新安装。<br>如果你的gerrit服务已经处于运行中，需要先执行下面的命令把它停掉</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ /home/gerrit/gerrit_site/bin/gerrit.sh stop</span><br></pre></td></tr></table></figure>
<p>然后直接删除<code>/home/gerrit/gerrit_site/</code>整个文件夹就好了。</p>
<p>如果你的gerrit服务没有正常退出，可能会发现这个文件夹删除不掉(cache 和 db这两个文件夹一直都会存在)，其实是因为还有gerrit的进程在跑，我们要做的是找出gerrit的进程，然后kill掉就好了</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ ps -ef | grep gerrit</span><br></pre></td></tr></table></figure>
<p align="center"><br>      <img src="http://img.cdn.microwu.com/20170118/1.png" width="800"><br></p>

<p>看上图中的最后一条，就是当前gerrit的进程，49513就是其进程id<br>我们接着执行</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">kill</span> -9 49513</span><br></pre></td></tr></table></figure>
<p>就强制关闭了gerrit进程，然后再试着删除整个<code>gerrit_site</code>文件夹就好了。</p>
<h2 id="删除git工程"><a href="#删除git工程" class="headerlink" title="删除git工程"></a>删除git工程</h2><p>如果你想删除一些无用的或者测试的git工程，只需要去<code>/home/gerrit/gerrit_site/git</code>目录下删除掉相应的工程，然后重启一下gerrit服务，同时，把浏览器整个关闭，然后再重新登录，就可以了。至于为什么要关闭掉整个浏览器，接着往下看：</p>
<h2 id="退出gerrit网页"><a href="#退出gerrit网页" class="headerlink" title="退出gerrit网页"></a>退出gerrit网页</h2><p>如果你已经成功登录了gerrit的网页，那么如果你想退出，请直接关闭整个浏览器，gerrit没有做logout的session清除，所以如果你直接点击网页右上角的logout，要么会出错，要么就会进入到之前那个提示需要反向代理的错误页面。关于登出，gerrit给出的原因是：</p>
<blockquote>
<p>You are using HTTP Basic authentication. There is no way to tell abrowser to quit sending basic authentication credentials, to logout with basicauthentication is to close the Webbrowser.</p>
</blockquote>
<h2 id="参考文献："><a href="#参考文献：" class="headerlink" title="参考文献："></a>参考文献：</h2><ol>
<li><a href="http://blog.csdn.net/benkaoya/article/details/8680886" target="_blank" rel="external">烤鸭的gerrit使用总结</a></li>
<li><a href="http://www.tuicode.com/article/5625189429df802c2c69d9d2" target="_blank" rel="external">Git服务器之Gerrit的搭建及第一次使用注意事项</a></li>
<li><a href="http://stackoverflow.com/questions/23798023/centos-how-to-uninstall-gerrit-server-from-centos-release-6-4" target="_blank" rel="external">CentOS: How to uninstall gerrit server from CentOS release 6.4</a></li>
</ol>
  
	</div>
		<footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/操作系统/">操作系统</a>
</div>


  <div class="article-tags">
  
  <span></span> <a href="/tags/Linux/">Linux</a><a href="/tags/Nginx/">Nginx</a><a href="/tags/Git/">Git</a><a href="/tags/Gerrit/">Gerrit</a>
  </div>

</div>



	<div class="article-share" id="share">
	
	  <div data-url="http://lipeng1667.github.io/2017/01/17/build-gerrit-with-nginx/" data-title="【Gerrit】Linux + Gerrit + Nginx + gitweb安装全过程 | KaKa&#39;s blog" data-tsina="undefined" class="share clearfix">
	  </div>
	
	</div>


</footer>

   	       
	</article>
	
<nav class="article-nav clearfix">
 
 <div class="prev" >
 <a href="/2017/01/18/gerrit-guide/" title="【Gerrit】Gerrit工作流程及使用手册">
  <strong>上一篇：</strong><br/>
  <span>
  【Gerrit】Gerrit工作流程及使用手册</span>
</a>
</div>


<div class="next">
<a href="/2017/01/03/android-webview-https-and-taobaoke/"  title="【Android】WebView加载HTTPS页面以及正确加载淘宝客连接">
 <strong>下一篇：</strong><br/> 
 <span>【Android】WebView加载HTTPS页面以及正确加载淘宝客连接
</span>
</a>
</div>

</nav>

	<section id="comments" class="comment">
  <div id="blog_comment"></div>
  <link rel="stylesheet" href="https://jjeejj.github.io/css/gitment.css">
  <script src="https://jjeejj.github.io/js/gitment.js"></script>
  <script>
  var gitment = new Gitment({
    id : 'Tue Jan 17 2017 14:43:49 GMT+0800',
    owner: 'lipeng1667',
    repo: 'gitment',
    oauth: {
      client_id: 'e6063b2ffad46d7387ab',
      client_secret: '4880a79cf8a57d05cee4efbd1c08494f7dc17b1a',
    },
  })
  gitment.render('blog_comment')
  </script>
</section>

</div>  
      <div class="openaside"><a class="navbutton" href="#" title="Show Sidebar"></a></div>

  <div id="toc" class="toc-aside">
  <strong class="toc-title">Contents</strong>
 
 <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#开发环境"><span class="toc-number">1.</span> <span class="toc-text">开发环境</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#安装gerrit"><span class="toc-number">2.</span> <span class="toc-text">安装gerrit</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#下载gerrit安装包"><span class="toc-number">2.1.</span> <span class="toc-text">下载gerrit安装包</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#新建gerrit专用用户"><span class="toc-number">2.2.</span> <span class="toc-text">新建gerrit专用用户</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#安装gerrit-1"><span class="toc-number">2.3.</span> <span class="toc-text">安装gerrit</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#启动gerrit"><span class="toc-number">2.4.</span> <span class="toc-text">启动gerrit</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Nginx"><span class="toc-number">3.</span> <span class="toc-text">Nginx</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#nginx默认配置"><span class="toc-number">3.1.</span> <span class="toc-text">nginx默认配置</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#gerrit-conf配置"><span class="toc-number">3.2.</span> <span class="toc-text">gerrit.conf配置</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#重启nginx"><span class="toc-number">3.3.</span> <span class="toc-text">重启nginx</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#登录认证文件"><span class="toc-number">3.4.</span> <span class="toc-text">登录认证文件</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#修改gerrit配置"><span class="toc-number">4.</span> <span class="toc-text">修改gerrit配置</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#重启gerrit"><span class="toc-number">4.1.</span> <span class="toc-text">重启gerrit</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#gitweb-可选"><span class="toc-number">5.</span> <span class="toc-text">gitweb(可选)</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#安装gitweb"><span class="toc-number">5.1.</span> <span class="toc-text">安装gitweb</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#修改gitweb配置文件"><span class="toc-number">5.2.</span> <span class="toc-text">修改gitweb配置文件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#修改Apache配置文件"><span class="toc-number">5.3.</span> <span class="toc-text">修改Apache配置文件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#修改gerrit配置-1"><span class="toc-number">5.4.</span> <span class="toc-text">修改gerrit配置</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#补充内容"><span class="toc-number">6.</span> <span class="toc-text">补充内容</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#卸载Gerrit"><span class="toc-number">6.1.</span> <span class="toc-text">卸载Gerrit</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#删除git工程"><span class="toc-number">6.2.</span> <span class="toc-text">删除git工程</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#退出gerrit网页"><span class="toc-number">6.3.</span> <span class="toc-text">退出gerrit网页</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#参考文献："><span class="toc-number">6.4.</span> <span class="toc-text">参考文献：</span></a></li></ol></li></ol>
 
  </div>

<div id="asidepart">
<div class="closeaside"><a class="closebutton" href="#" title="Hide Sidebar"></a></div>
<aside class="clearfix">

  
<div class="categorieslist">
	<p class="asidetitle">Categories</p>
		<ul>
		
		  
			<li><a href="/categories/个人随想/" title="个人随想">个人随想<sup>6</sup></a></li>
		  
		
		  
			<li><a href="/categories/前端技术/" title="前端技术">前端技术<sup>3</sup></a></li>
		  
		
		  
			<li><a href="/categories/技术杂谈/" title="技术杂谈">技术杂谈<sup>7</sup></a></li>
		  
		
		  
			<li><a href="/categories/操作系统/" title="操作系统">操作系统<sup>12</sup></a></li>
		  
		
		  
			<li><a href="/categories/Database/" title="数据库">数据库<sup>2</sup></a></li>
		  
		
		  
			<li><a href="/categories/移动开发/" title="移动开发">移动开发<sup>12</sup></a></li>
		  
		
		  
			<li><a href="/categories/编程语言/" title="编程语言">编程语言<sup>2</sup></a></li>
		  
		
		</ul>
</div>


  
<div class="tagslist">
	<p class="asidetitle">Tags</p>
		<ul class="clearfix">
		
			
				<li><a href="/tags/Linux/" title="Linux">Linux<sup>10</sup></a></li>
			
		
			
				<li><a href="/tags/Android/" title="Android">Android<sup>10</sup></a></li>
			
		
			
				<li><a href="/tags/PHP/" title="PHP">PHP<sup>5</sup></a></li>
			
		
			
				<li><a href="/tags/MySQL/" title="MySQL">MySQL<sup>4</sup></a></li>
			
		
			
				<li><a href="/tags/WebView/" title="WebView">WebView<sup>4</sup></a></li>
			
		
			
				<li><a href="/tags/JavaScript/" title="JavaScript">JavaScript<sup>3</sup></a></li>
			
		
			
				<li><a href="/tags/gitbook/" title="gitbook">gitbook<sup>2</sup></a></li>
			
		
			
				<li><a href="/tags/Nginx/" title="Nginx">Nginx<sup>2</sup></a></li>
			
		
			
				<li><a href="/tags/Git/" title="Git">Git<sup>2</sup></a></li>
			
		
			
				<li><a href="/tags/Gerrit/" title="Gerrit">Gerrit<sup>2</sup></a></li>
			
		
			
				<li><a href="/tags/Python/" title="Python">Python<sup>2</sup></a></li>
			
		
			
				<li><a href="/tags/AndroidStudio/" title="AndroidStudio">AndroidStudio<sup>2</sup></a></li>
			
		
			
				<li><a href="/tags/Apache/" title="Apache">Apache<sup>2</sup></a></li>
			
		
			
				<li><a href="/tags/Oracle/" title="Oracle">Oracle<sup>2</sup></a></li>
			
		
			
				<li><a href="/tags/Eclipse/" title="Eclipse">Eclipse<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/PDO/" title="PDO">PDO<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/SS/" title="SS">SS<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/SSH/" title="SSH">SSH<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/开源/" title="开源">开源<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/gitlab/" title="gitlab">gitlab<sup>1</sup></a></li>
			
		
		</ul>
</div>


</aside>
</div>
    </div>
    <footer><div id="footer" >
	
	<div class="line">
		<span></span>
		<div class="author"></div>
	</div>
	
	
	<section class="info">
		<p> Hello ,I&#39;m Michael Lee. Life is for sharing! <br/>
			伪文青，伪球迷，却绝不做虚伪的人; 爱编程，爱皇马，好好学习天天向上!</p>
	</section>
	 
	<div class="social-font" class="clearfix">
		
		<a href="http://weibo.com/331578923" target="_blank" class="icon-weibo" title="微博"></a>
		
		
		<a href="https://github.com/lipeng1667" target="_blank" class="icon-github" title="github"></a>
		
		
		<a href="http://stackoverflow.com/users/3822574" target="_blank" class="icon-stack-overflow" title="stackoverflow"></a>
		
		
		<a href="https://twitter.com/Leepeng1667" target="_blank" class="icon-twitter" title="twitter"></a>
		
		
		<a href="https://www.facebook.com/peng.li.5011516" target="_blank" class="icon-facebook" title="facebook"></a>
		
		
		
		<a href="https://www.douban.com/people/58389742" target="_blank" class="icon-douban" title="豆瓣"></a>
		
		
		
		
		<a href="mailto:lipeng1667@gmail.com" target="_blank" class="icon-email" title="Email Me"></a>
		
	</div>
			
		

        <span class="busuanzi_container_site_pv">
          本站总访问量<span id="busuanzi_value_site_pv"></span>次
        </span>

		<p class="copyright">
		Powered by <a href="http://hexo.io" target="_blank" title="hexo">hexo</a> and Theme by <a href="https://github.com/wuchong/jacman" target="_blank" title="Jacman">Jacman</a> © 2019 
		
		<a href="/about" target="_blank" title="Michael Lee">Michael Lee</a>
		
		
		</p>
</div>
</footer>
    <script src="/js/jquery-2.0.3.min.js"></script>
<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>
<script src="/js/jquery.qrcode-0.12.0.min.js"></script>

<script type="text/javascript">
$(document).ready(function(){ 
  $('.navbar').click(function(){
    $('header nav').toggleClass('shownav');
  });
  var myWidth = 0;
  function getSize(){
    if( typeof( window.innerWidth ) == 'number' ) {
      myWidth = window.innerWidth;
    } else if( document.documentElement && document.documentElement.clientWidth) {
      myWidth = document.documentElement.clientWidth;
    };
  };
  var m = $('#main'),
      a = $('#asidepart'),
      c = $('.closeaside'),
      o = $('.openaside');
  c.click(function(){
    a.addClass('fadeOut').css('display', 'none');
    o.css('display', 'block').addClass('fadeIn');
    m.addClass('moveMain');
  });
  o.click(function(){
    o.css('display', 'none').removeClass('beforeFadeIn');
    a.css('display', 'block').removeClass('fadeOut').addClass('fadeIn');      
    m.removeClass('moveMain');
  });
  $(window).scroll(function(){
    o.css("top",Math.max(80,260-$(this).scrollTop()));
  });
  
  $(window).resize(function(){
    getSize(); 
    if (myWidth >= 1024) {
      $('header nav').removeClass('shownav');
    }else{
      m.removeClass('moveMain');
      a.css('display', 'block').removeClass('fadeOut');
      o.css('display', 'none');
      
      $('#toc.toc-aside').css('display', 'none');
        
    }
  });
});
</script>

<script type="text/javascript">
$(document).ready(function(){ 
  var ai = $('.article-content>iframe'),
      ae = $('.article-content>embed'),
      t  = $('#toc'),
      ta = $('#toc.toc-aside'),
      o  = $('.openaside'),
      c  = $('.closeaside');
  if(ai.length>0){
    ai.wrap('<div class="video-container" />');
  };
  if(ae.length>0){
   ae.wrap('<div class="video-container" />');
  };
  c.click(function(){
    ta.css('display', 'block').addClass('fadeIn');
  });
  o.click(function(){
    ta.css('display', 'none');
  });
  $(window).scroll(function(){
    ta.css("top",Math.max(140,320-$(this).scrollTop()));
  });
});
</script>


<script type="text/javascript">
$(document).ready(function(){ 
  var $this = $('.share'),
      url = $this.attr('data-url'),
      encodedUrl = encodeURIComponent(url),
      title = $this.attr('data-title'),
      tsina = $this.attr('data-tsina'),
      description = $this.attr('description');
  var html = [
  '<div class="hoverqrcode clearfix"></div>',
  '<a class="overlay" id="qrcode"></a>',
  '<a href="https://www.facebook.com/sharer.php?u=' + encodedUrl + '" class="article-share-facebook" target="_blank" title="Facebook"></a>',
  '<a href="https://twitter.com/intent/tweet?url=' + encodedUrl + '" class="article-share-twitter" target="_blank" title="Twitter"></a>',
  '<a href="#qrcode" class="article-share-qrcode" title="微信"></a>',
  '<a href="http://widget.renren.com/dialog/share?resourceUrl=' + encodedUrl + '&srcUrl=' + encodedUrl + '&title=' + title +'" class="article-share-renren" target="_blank" title="人人"></a>',
  '<a href="http://service.weibo.com/share/share.php?title='+title+'&url='+encodedUrl +'&ralateUid='+ tsina +'&searchPic=true&style=number' +'" class="article-share-weibo" target="_blank" title="微博"></a>',
  '<span title="Share to"></span>'
  ].join('');
  $this.append(html);

  $('.hoverqrcode').hide();

  var myWidth = 0;
  function updatehoverqrcode(){
    if( typeof( window.innerWidth ) == 'number' ) {
      myWidth = window.innerWidth;
    } else if( document.documentElement && document.documentElement.clientWidth) {
      myWidth = document.documentElement.clientWidth;
    };
    var qrsize = myWidth > 1024 ? 200:100;
    var options = {render: 'image', size: qrsize, fill: '#2ca6cb', text: url, radius: 0.5, quiet: 1};
    var p = $('.article-share-qrcode').position();
    $('.hoverqrcode').empty().css('width', qrsize).css('height', qrsize)
                          .css('left', p.left-qrsize/2+20).css('top', p.top-qrsize-10)
                          .qrcode(options);
  };
  $(window).resize(function(){
    $('.hoverqrcode').hide();
  });
  $('.article-share-qrcode').click(function(){
    updatehoverqrcode();
    $('.hoverqrcode').toggle();
  });
  $('.article-share-qrcode').hover(function(){}, function(){
      $('.hoverqrcode').hide();
  });
});   
</script>



<script type="text/javascript">

var disqus_shortname = 'lipeng1667';

(function(){
  var dsq = document.createElement('script');
  dsq.type = 'text/javascript';
  dsq.async = true;
  dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
  (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
}());
(function(){
  var dsq = document.createElement('script');
  dsq.type = 'text/javascript';
  dsq.async = true;
  dsq.src = '//' + disqus_shortname + '.disqus.com/count.js';
  (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
}());
</script>






<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
$(document).ready(function(){ 
  $('.article-content').each(function(i){
    $(this).find('img').each(function(){
      if ($(this).parent().hasClass('fancybox')) return;
      var alt = this.alt;
      if (alt) $(this).after('<span class="caption">' + alt + '</span>');
      $(this).wrap('<a href="' + this.src + '" title="' + alt + '" class="fancybox"></a>');
    });
    $(this).find('.fancybox').each(function(){
      $(this).attr('rel', 'article' + i);
    });
  });
  if($.fancybox){
    $('.fancybox').fancybox();
  }
}); 
</script>


<script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js">
</script>

<!-- Analytics Begin -->

<script type="text/javascript">
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');
ga('create', 'UA-73232459-1', 'null');  
ga('send', 'pageview');
</script>





<!-- Analytics End -->

<!-- Totop Begin -->

	<div id="totop">
	<a title="Back to Top"><img src="/img/scrollup.png"/></a>
	</div>
	<script src="/js/totop.js"></script>

<!-- Totop End -->

<!-- MathJax Begin -->
<!-- mathjax config similar to math.stackexchange -->


<!-- MathJax End -->

<!-- Tiny_search Begin -->

<!-- Tiny_search End -->

  </body>
</html>
