
 <!DOCTYPE HTML>
<html lang="zh-CN：">
<head>
  <meta charset="UTF-8">
  
    <title>【Gerrit】Gerrit工作流程及使用手册 | KaKa&#39;s blog</title>
    <meta name="viewport" content="width=device-width, initial-scale=1,user-scalable=no">
    
    <meta name="author" content="Michael Lee">
    

    
    <meta name="description" content="上一篇文章中，我们介绍了如何安装和正确配置gerrit，相对于gerrit的使用，它的安装真的算简单的了。gerrit的流程、权限控制其实对于初次接触的同学们来说，确实有点复杂。我希望这篇文章过后，我们能对gerrit的流程有一个大致的了解。这篇文章将用一个真实的例子，演示一下gerrit的管理员，普通项目成员是如何协同完成项目管理工作的。">
<meta property="og:type" content="article">
<meta property="og:title" content="【Gerrit】Gerrit工作流程及使用手册">
<meta property="og:url" content="http://lipeng1667.github.io/2017/01/18/gerrit-guide/index.html">
<meta property="og:site_name" content="KaKa's blog">
<meta property="og:description" content="上一篇文章中，我们介绍了如何安装和正确配置gerrit，相对于gerrit的使用，它的安装真的算简单的了。gerrit的流程、权限控制其实对于初次接触的同学们来说，确实有点复杂。我希望这篇文章过后，我们能对gerrit的流程有一个大致的了解。这篇文章将用一个真实的例子，演示一下gerrit的管理员，普通项目成员是如何协同完成项目管理工作的。">
<meta property="og:image" content="http://7xqppk.com1.z0.glb.clouddn.com/20170118/2.png">
<meta property="og:image" content="http://7xqppk.com1.z0.glb.clouddn.com/20170118/3.png">
<meta property="og:image" content="http://7xqppk.com1.z0.glb.clouddn.com/20170118/4.png">
<meta property="og:image" content="http://7xqppk.com1.z0.glb.clouddn.com/20170118/10.png">
<meta property="og:image" content="http://7xqppk.com1.z0.glb.clouddn.com/20170118/5.png">
<meta property="og:image" content="http://7xqppk.com1.z0.glb.clouddn.com/20170118/7.png">
<meta property="og:image" content="http://7xqppk.com1.z0.glb.clouddn.com/20170118/8.png">
<meta property="og:image" content="http://7xqppk.com1.z0.glb.clouddn.com/20170118/11.png">
<meta property="og:image" content="http://7xqppk.com1.z0.glb.clouddn.com/20170118/9.png">
<meta property="og:image" content="http://7xqppk.com1.z0.glb.clouddn.com/20170118/12.png">
<meta property="og:image" content="http://7xqppk.com1.z0.glb.clouddn.com/20170118/13.png">
<meta property="og:image" content="http://7xqppk.com1.z0.glb.clouddn.com/20170118/14.png">
<meta property="og:image" content="http://7xqppk.com1.z0.glb.clouddn.com/20170118/15.png">
<meta property="og:image" content="http://7xqppk.com1.z0.glb.clouddn.com/20170118/16.png">
<meta property="og:image" content="http://7xqppk.com1.z0.glb.clouddn.com/20170118/17.png">
<meta property="og:image" content="http://7xqppk.com1.z0.glb.clouddn.com/20170118/18.png">
<meta property="og:image" content="http://7xqppk.com1.z0.glb.clouddn.com/20170118/19.png">
<meta property="og:image" content="http://7xqppk.com1.z0.glb.clouddn.com/20170118/20.png">
<meta property="og:image" content="http://7xqppk.com1.z0.glb.clouddn.com/20170118/21.png">
<meta property="og:image" content="http://7xqppk.com1.z0.glb.clouddn.com/20170118/22.png">
<meta property="og:image" content="http://7xqppk.com1.z0.glb.clouddn.com/20170118/23.png">
<meta property="og:image" content="http://7xqppk.com1.z0.glb.clouddn.com/20170118/24.png">
<meta property="og:image" content="http://7xqppk.com1.z0.glb.clouddn.com/20170118/25.png">
<meta property="og:image" content="http://7xqppk.com1.z0.glb.clouddn.com/20170118/26.png">
<meta property="og:image" content="http://7xqppk.com1.z0.glb.clouddn.com/20170118/27.png">
<meta property="og:image" content="http://7xqppk.com1.z0.glb.clouddn.com/20170118/28.png">
<meta property="og:image" content="http://7xqppk.com1.z0.glb.clouddn.com/20170118/30.png">
<meta property="og:image" content="http://7xqppk.com1.z0.glb.clouddn.com/20170118/29.png">
<meta property="og:image" content="http://7xqppk.com1.z0.glb.clouddn.com/20170118/31.png">
<meta property="og:image" content="http://7xqppk.com1.z0.glb.clouddn.com/20170118/32.png">
<meta property="og:image" content="http://7xqppk.com1.z0.glb.clouddn.com/20170118/33.png">
<meta property="og:image" content="http://7xqppk.com1.z0.glb.clouddn.com/20170118/34.png">
<meta property="og:image" content="http://7xqppk.com1.z0.glb.clouddn.com/20170118/35.png">
<meta property="og:image" content="http://7xqppk.com1.z0.glb.clouddn.com/20170118/41.png">
<meta property="og:image" content="http://7xqppk.com1.z0.glb.clouddn.com/20170118/36.png">
<meta property="og:image" content="http://7xqppk.com1.z0.glb.clouddn.com/20170118/38.png">
<meta property="og:image" content="http://7xqppk.com1.z0.glb.clouddn.com/20170118/37.png">
<meta property="og:image" content="http://7xqppk.com1.z0.glb.clouddn.com/20170118/39.png">
<meta property="og:image" content="http://7xqppk.com1.z0.glb.clouddn.com/20170118/40.png">
<meta property="og:image" content="http://7xqppk.com1.z0.glb.clouddn.com/20170118/42.png">
<meta property="og:image" content="http://7xqppk.com1.z0.glb.clouddn.com/20170118/43.png">
<meta property="og:image" content="http://7xqppk.com1.z0.glb.clouddn.com/20170118/44.png">
<meta property="og:image" content="http://7xqppk.com1.z0.glb.clouddn.com/20170118/45.png">
<meta property="og:image" content="http://7xqppk.com1.z0.glb.clouddn.com/20170118/46.png">
<meta property="og:image" content="http://7xqppk.com1.z0.glb.clouddn.com/20170118/47.png">
<meta property="og:image" content="http://7xqppk.com1.z0.glb.clouddn.com/20170118/48.png">
<meta property="og:image" content="http://7xqppk.com1.z0.glb.clouddn.com/20170118/49.png">
<meta property="og:updated_time" content="2017-01-18T09:35:33.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="【Gerrit】Gerrit工作流程及使用手册">
<meta name="twitter:description" content="上一篇文章中，我们介绍了如何安装和正确配置gerrit，相对于gerrit的使用，它的安装真的算简单的了。gerrit的流程、权限控制其实对于初次接触的同学们来说，确实有点复杂。我希望这篇文章过后，我们能对gerrit的流程有一个大致的了解。这篇文章将用一个真实的例子，演示一下gerrit的管理员，普通项目成员是如何协同完成项目管理工作的。">
<meta name="twitter:image" content="http://7xqppk.com1.z0.glb.clouddn.com/20170118/2.png">
<meta name="twitter:creator" content="@Leepeng1667">

    
    <link rel="alternative" href="/atom.xml" title="KaKa&#39;s blog" type="application/atom+xml">
    
    
    <link rel="icon" href="/img/favicon.ico">
    
    
    <link rel="apple-touch-icon" href="/img/jacman.jpg">
    <link rel="apple-touch-icon-precomposed" href="/img/jacman.jpg">
    
    <link rel="stylesheet" href="/css/style.css">
</head>

  <body>
    <header>
      
<div>
		
			<div id="imglogo">
				<a href="/"><img src="/img/logo_.png" alt="KaKa&#39;s blog" title="KaKa&#39;s blog"/></a>
			</div>
			
			<div id="textlogo">
				<h1 class="site-name"><a href="/" title="KaKa&#39;s blog">KaKa&#39;s blog</a></h1>
				<h2 class="blog-motto">It is more important to know where you are going than to get there quickly. Do not mistake activity for achievement.</h2>
			</div>
			<div class="navbar"><a class="navbutton navmobile" href="#" title="Menu">
			</a></div>
			<nav class="animated">
				<ul>
					<ul>
					 
						<li><a href="/">Home</a></li>
					
						<li><a href="/archives">Archives</a></li>
					
					<li>
 					
					<form class="search" action="//google.com/search" method="get" accept-charset="utf-8">
						<label>Search</label>
						<input type="search" id="search" name="q" autocomplete="off" maxlength="20" placeholder="Search" />
						<input type="hidden" name="q" value="site:lipeng1667.github.io">
					</form>
					
					</li>
				</ul>
			</nav>			
</div>
    </header>
    <div id="container">
      <div id="main" class="post" itemscope itemprop="blogPost">
  
	<article itemprop="articleBody"> 
		<header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2017/01/18/gerrit-guide/" title="【Gerrit】Gerrit工作流程及使用手册" itemprop="url">【Gerrit】Gerrit工作流程及使用手册</a>
  </h1>
  <p class="article-author">BY
       
		<a href="/about" title="Michael Lee" target="_blank" itemprop="author">Michael Lee</a>
		
  <p class="article-time">
    <time datetime="2017-01-18T01:55:41.000Z" itemprop="datePublished"> Published 2017-01-18</time>
  </p>
  
  <p class="page-count">
    阅读数:<span id="busuanzi_value_page_pv"></span>
  </p>

</header>

	<div class="article-content">
		
		<div id="toc" class="toc-article">
			<strong class="toc-title">Contents</strong>
		
			<ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#gerrit工作流程"><span class="toc-number">1.</span> <span class="toc-text">gerrit工作流程</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#管理员配置"><span class="toc-number">2.</span> <span class="toc-text">管理员配置</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#profile"><span class="toc-number">2.1.</span> <span class="toc-text">profile</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Preferences"><span class="toc-number">2.2.</span> <span class="toc-text">Preferences</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Watched-Projects"><span class="toc-number">2.3.</span> <span class="toc-text">Watched Projects</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Contact-Information"><span class="toc-number">2.4.</span> <span class="toc-text">Contact Information</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SSH-Public-Keys"><span class="toc-number">2.5.</span> <span class="toc-text">SSH Public Keys</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#生成公私钥对"><span class="toc-number">2.5.1.</span> <span class="toc-text">生成公私钥对</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#找到公钥文件"><span class="toc-number">2.5.2.</span> <span class="toc-text">找到公钥文件</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Groups"><span class="toc-number">2.6.</span> <span class="toc-text">Groups</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#示例"><span class="toc-number">3.</span> <span class="toc-text">示例</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#管理员设置SSH"><span class="toc-number">3.1.</span> <span class="toc-text">管理员设置SSH</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#添加普通成员"><span class="toc-number">3.2.</span> <span class="toc-text">添加普通成员</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#修改用户所在组"><span class="toc-number">3.3.</span> <span class="toc-text">修改用户所在组</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#新建和修改项目"><span class="toc-number">3.4.</span> <span class="toc-text">新建和修改项目</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#test3用户clone工程"><span class="toc-number">3.5.</span> <span class="toc-text">test3用户clone工程</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#提交"><span class="toc-number">3.6.</span> <span class="toc-text">提交</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#管理员审查"><span class="toc-number">3.7.</span> <span class="toc-text">管理员审查</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#事件处理"><span class="toc-number">3.7.1.</span> <span class="toc-text">事件处理</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#SourceTree"><span class="toc-number">4.</span> <span class="toc-text">SourceTree</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#设置自定义push"><span class="toc-number">4.1.</span> <span class="toc-text">设置自定义push</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#致谢-amp-参考文文章"><span class="toc-number">5.</span> <span class="toc-text">致谢&参考文文章</span></a></li></ol>
		
		</div>
		
		<p><a href="http://lipeng1667.github.io/2017/01/17/build-gerrit-with-nginx/">上一篇文章</a>中，我们介绍了如何安装和正确配置gerrit，相对于gerrit的使用，它的安装真的算简单的了。<br>gerrit的流程、权限控制其实对于初次接触的同学们来说，确实有点复杂。我希望这篇文章过后，我们能对gerrit的流程有一个大致的了解。<br>这篇文章将用一个真实的例子，演示一下gerrit的管理员，普通项目成员是如何协同完成项目管理工作的。</p>
<a id="more"></a>
<p>这篇文章首先会大致讲解下gerrit的工作流程；然后介绍管理员的相关配置工作，包括设置SSH密钥验证，添加新成员；接下来会用一个示例演示普通成员push一个commit之后，代码审核员是如何进行审核的；最后介绍一下如何使用sourceTree上传代码到gerrit服务器。</p>
<p>提醒：<br>这篇文章需要一定的git基础，如果你还不熟悉git，请先学习下关于git的相关知识。<br>这篇文章中的所有操作不再需要登录到gerrit服务器上去了，因为所有的操作都是在管理员或者普通成员的电脑上完成的，至于管理员对组员的操作，也可以在管理员自己的电脑上通过SSH连接到gerrit服务器上完成。</p>
<h1 id="gerrit工作流程"><a href="#gerrit工作流程" class="headerlink" title="gerrit工作流程"></a>gerrit工作流程</h1><p>好不容易在google上找了一篇相对简单明了的介绍gerrit工作流程的图：</p>
<p align="center"><br>  <img src="http://7xqppk.com1.z0.glb.clouddn.com/20170118/2.png" width="500"><br></p>

<p>使用过git的同学，都知道，当我们<code>git add --&gt; git commit --&gt; git push</code> 之后，你的代码会被直接提交到repo，也就是代码仓库中，就是图中橘红色箭头指示的那样。</p>
<p>那么gerrit就是上图中的那只鸟，普通成员的代码是被先push到gerrit服务器上，然后由代码审核人员，就是左上角的integrator在web页面进行代码的审核(review)，可以单人审核，也可以邀请其他成员一同审核，当代码审核通过(approve)之后，这次代码才会被提交(submit)到代码仓库(repo)中去。</p>
<p>无论有新的代码提交待审核，代码审核通过或被拒绝，代码提交者(Contributor)和所有的相关代码审核人员(Integrator)都会收到邮件提醒。<br>gerrit还有自动测试的功能，和主线有冲突或者测试不通过的代码，是会被直接拒绝掉的，这个功能似乎就是右下角那个老头(Jenkins)的任务。</p>
<p>整个流程就是这样。 在使用过程中，有两点需要特别注意下：</p>
<ol>
<li>当进行commit时，必须要生成一个Change-Id，否则，push到gerrit服务器时，会收到一个错误提醒。</li>
<li><p>提交者不能直接把代码推到远程的master主线(或者其他远程分支)上去。这样就相当于越过了gerrit了。 gerrit必须依赖于一个<code>refs/for/*</code>的分支。</p>
<p> 假如我们远程只有一个master主线，那么只有当你的代码被提交到<code>refs/for/master</code>分支时，gerrit才会知道，我收到了一个需要审核的代码推送，需要通知审核员来审核代码了。<br> 当审核通过之后，gerrit会自动将这条分支合并到master主线上，然后邮件通知相关成员，master分支有更新，需要的成员再去pull就好了。而且这条<code>refs/for/master</code>分支，是透明的，也就是说普通成员其实是不需要知道这条线的，如果你正确配置了sourceTree，你也应该是看不到这条线的。</p>
</li>
</ol>
<font color="red">这两点很重要！！这两点很重要！！这两点很重要！！</font>

<p>这两点在稍后的示例中，我们会依次介绍。</p>
<h1 id="管理员配置"><a href="#管理员配置" class="headerlink" title="管理员配置"></a>管理员配置</h1><p>在上一篇文章的最后，我们做为管理员，初次登录到了gerrit的web页面中，接下来还有很多内容需要设置一下。我们依次来看看吧。</p>
<h2 id="profile"><a href="#profile" class="headerlink" title="profile"></a>profile</h2><p align="center"><br>  <img src="http://7xqppk.com1.z0.glb.clouddn.com/20170118/3.png" width="800"><br></p>

<p>初次登录时，Full Name 和 Email Address 字段都是空的，待会我们会一一设置。没有设置之前，右上角显示的用户名称也是<code>admin</code></p>
<h2 id="Preferences"><a href="#Preferences" class="headerlink" title="Preferences"></a>Preferences</h2><p align="center"><br>  <img src="http://7xqppk.com1.z0.glb.clouddn.com/20170118/4.png" width="800"><br></p>

<p>Preferences页面用于配置gerrit的web页面，我一般把时间格式改成习惯的24小时制，同时确保<code>Email Nofification</code>处于开启状态，这个默认就是开启的；然后在<code>Show Change Number In Changes Tables</code>打上勾，这样能清楚地看到每个审核的编号，邮件里面显示的也是这个编号。</p>
<h2 id="Watched-Projects"><a href="#Watched-Projects" class="headerlink" title="Watched Projects"></a>Watched Projects</h2><p>这里有必要先说一下gerrit的两个默认项目：</p>
<p>我们点击左上方的菜单栏 Projects –&gt; List，就能看到两个默认的项目<code>All-Projects</code>和 <code>All-Users</code>，这两个工程是两个基础的工程，我们新建的工程默认都是继承自<code>All-Projects</code>的权限。关于权限部分我们在后面的章节详细介绍。</p>
<p align="center"><br>  <img src="http://7xqppk.com1.z0.glb.clouddn.com/20170118/10.png" width="800"><br></p>

<p>所以在<code>Watched Projects</code>菜单中，就是当前用户要监听的项目，当这些项目发生变化时，你会收到邮件提醒，如果你选择了<code>All-Projects</code>，那么就意味着你要监听所有的工程，因为所有工程都会默认继承自<code>All-Projects</code>。</p>
<p align="center"><br>  <img src="http://7xqppk.com1.z0.glb.clouddn.com/20170118/5.png" width="800"><br></p>

<p>注意，后面的那些选项，勾选了某一项，就表示仅仅给当前项发送邮件提醒，保险期间，我们就全部勾上就好了。</p>
<h2 id="Contact-Information"><a href="#Contact-Information" class="headerlink" title="Contact Information"></a>Contact Information</h2><p align="center"><br>  <img src="http://7xqppk.com1.z0.glb.clouddn.com/20170118/7.png" width="800"><br></p>

<p>这里是当前账号的配置，你可以在这里把full-name填写完全，这样右上角也会同步更新你刚设置好的名称。</p>
<p>注意这里的Preferred Email有两种设置方法：</p>
<ol>
<li>如果你的邮件服务器配置完成了(不清楚如何配置的同学请参见<a href="http://lipeng1667.github.io/2017/01/17/build-gerrit-with-nginx/">上一篇文章</a>)，可以点击<code>Register New Email</code>，你就会收到一封确认邮件，确认之后就能设置好了。</li>
<li>通过SSH在命令行中进行配置，通过命令行进行配置是最方便快捷，也是最优先推荐的方法。</li>
</ol>
<p>不过因为SSH命令行的方式需要配置SSH公钥，所以我们这里先留空，一会通过命令行来配置。</p>
<h2 id="SSH-Public-Keys"><a href="#SSH-Public-Keys" class="headerlink" title="SSH Public Keys"></a>SSH Public Keys</h2><p align="center"><br>  <img src="http://7xqppk.com1.z0.glb.clouddn.com/20170118/8.png" width="800"><br></p>

<p>这里需要把你的公钥内容拷贝出来，然后粘贴到对话框中。我简单演示下如何操作。</p>
<h3 id="生成公私钥对"><a href="#生成公私钥对" class="headerlink" title="生成公私钥对"></a>生成公私钥对</h3><p>如果你之前有使用过git，那你一定已经生成了公私钥对，可以直接跳过这个步骤。<br>在命令行中输入下面的内容：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ ssh-keygen -t rsa</span><br></pre></td></tr></table></figure>
<p>然后会提示你输入一个密码，用来访问公私钥，可以直接回车表示不加密码。接下来就会自动帮你创建好一对公私钥了。</p>
<h3 id="找到公钥文件"><a href="#找到公钥文件" class="headerlink" title="找到公钥文件"></a>找到公钥文件</h3><p>默认公私钥的是放置在<code>~/.ssh</code>目录下的，默认的名称是<code>id_rsa</code>和<code>id_rsa.pub</code>。其中<code>.pub</code>文件就是公钥，私钥你自己需要保存好。我们来看下我的.ssh文件夹中的内容</p>
<p align="center"><br>  <img src="http://7xqppk.com1.z0.glb.clouddn.com/20170118/11.png" width="400"><br></p>

<ul>
<li>config是ssh的配置文件，稍后我们会演示通过管理员ssh连接到gerrit服务器时，会在来看这个文件</li>
<li>lipeng和lipeng.pub分别是我的私钥和公钥</li>
</ul>
<p>我们要做的，就是把公钥的内容拷贝出来，然后粘贴到页面上去。<br>注意拷贝时，要从<code>RSA</code>开始拷贝，如果格式不对，页面上会有提示。<br>还有一点要说明的是，这些都是在你想要作为管理员账号的机器上操作完成，对我来说，我的macbook就是管理员要使用的电脑。</p>
<h2 id="Groups"><a href="#Groups" class="headerlink" title="Groups"></a>Groups</h2><p align="center"><br>  <img src="http://7xqppk.com1.z0.glb.clouddn.com/20170118/9.png" width="800"><br></p>

<p>最后来看一下gerrit的分组。图片里面是gerrit默认的几个分组，我们需要知道的是<code>Administrator</code>就是管理员分组，<code>Anonymous Users</code>指的是所有添加到gerrit数据库中的成员都默认加入的一个组。之后我们还可以建立新的分组，加入新的成员等等。</p>
<h1 id="示例"><a href="#示例" class="headerlink" title="示例"></a>示例</h1><p>接下来我们来做一个演示，看看一个新的成员是如何被添加到gerrit服务器中，然后他们又是如何协同工作的。<br>这里一共涉及到两个角色，一个是管理员，一个是普通成员。</p>
<h2 id="管理员设置SSH"><a href="#管理员设置SSH" class="headerlink" title="管理员设置SSH"></a>管理员设置SSH</h2><p>在之前的文章中我们提到过，gerrit自带的H2数据库就完全够用了，对成员的管理，邮件添加等操作，均可以通过SSH来完成。那第一步我们就来看一下管理员如何才能远程SSH到gerrit服务器。</p>
<p>首先确保在之前，已经成功把你的公钥添加到了web页面账户中。<br>接下来，需要修改之前<code>~/.ssh/</code>文件夹下面的config文件，我们拿我的config文件做为示例，做个讲解。</p>
<p>我们还是先进入到<code>~/.ssh/</code>文件夹中</p>
<p align="center"><br>  <img src="http://7xqppk.com1.z0.glb.clouddn.com/20170118/12.png" width="400"><br></p>

<p>然后查看一下<code>config</code>文件： <code>vim config</code></p>
<p align="center"><br>  <img src="http://7xqppk.com1.z0.glb.clouddn.com/20170118/13.png" width="500"><br></p>

<p>我们看到这里面有两个Host部分，我们重点来看第2个Host部分，这个是我们新建的，用于连接到gerrit服务器的配置。</p>
<p>照猫画虎，对于我们之前建立在<code>192.168.1.100</code>的gerrit服务器来说，你的<code>Host</code>配置可能如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Host gerrit</span><br><span class="line">HostName &quot;192.168.1.100&quot;</span><br><span class="line">User &quot;admin&quot;</span><br><span class="line">IndentityFile &quot;~/.ssh/id_rsa&quot;</span><br><span class="line">port 29418</span><br></pre></td></tr></table></figure>
<p>User要和我们在gerrit服务器上注册的名称保持一致( <strong>不是</strong> full-name)，认证文件注意要和公钥对应的私钥文件，端口要填写gerrit服务的端口号，这里是默认的<code>29418</code>。</p>
<p>配置完config文件，我们就可以SSH到gerrit了，我们来尝试一下吧：</p>
<p align="center"><br>  <img src="http://7xqppk.com1.z0.glb.clouddn.com/20170118/14.png" width="400"><br></p>

<p>我们在管理员的机器上，输入<code>ssh gerrit -l admin</code>命令，就可以得到gerrit服务器的响应，只不过因为我们禁用了shell，所以连接很快断开了，没有关系，这样证明做为管理员，已经可以通过命令行对gerrit服务器进行一系列的操作了。</p>
<h2 id="添加普通成员"><a href="#添加普通成员" class="headerlink" title="添加普通成员"></a>添加普通成员</h2><p>在管理员添加新的组员之前，我们需要先在普通成员的机器上生成ssh的公私钥，这里方便描述，我们把这个普通成员命名为test3。</p>
<p>在test3的电脑命令行中，生成利用<code>ssh-keygen</code>命令，生成公私钥。</p>
<p align="center"><br>  <img src="http://7xqppk.com1.z0.glb.clouddn.com/20170118/15.png" width="400"><br></p>

<p>我们就使用默认的id_rsa命名好了。</p>
<p>接下来，test3成员需要把<code>id_rsa.pub</code>公钥发送给管理员，这样管理员才能正常把test3添加到gerrit用户组中。<br>我们假设管理员将test3的pub公钥放到了<code>~/home</code>目录下，也就是说，在管理员的电脑上，test3的公钥存放在<code>~/home/id_rsa.pub</code>文件，当然我们也可以重新把它命名为<code>test3.pub</code>，方便演示我这里就不做更名处理了，</p>
<p>接下来，管理员在命令行中输入如下的命令来完成添加普通成员的操作。注意： 这个命令很强大很方便，可以一步到位地把成员的的名称，全名，邮箱以及ssh公钥认证全部设置好。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ cat ~/home/id_rsa.pub | ssh gerrit gerrit create-account --full-name <span class="built_in">test</span>3 --email <span class="built_in">test</span>3@microwu.com --ssh-key - <span class="built_in">test</span>3</span><br></pre></td></tr></table></figure>
<p>接下来我们来详细看一下这个命令：</p>
<ul>
<li><code>|</code> 符号把这个命令分成了两部分，第一部分的<code>cat ~/home/id_rsa.pub</code>表示把test3的公钥内容读入到输入流中</li>
<li>ssh gerrit是我们之前在<code>~/.ssh/config</code>中配置好的gerrit服务器地址</li>
<li>又接着一个gerrit表示通过ssh中输入gerrit命令来进行相关操作</li>
<li>create-account 表示要新建用户。注意，新建的用户名写在最后面，中间是其他参数</li>
<li>full-name 就如同页面中的全名，我们这里命名为test3</li>
<li>email表示该用户的email地址，我们填入 test3@microwu.com</li>
<li>ssh-key - 注意，最后的<code>-</code> 表示从输入流中读取ssh的公钥内容，也就是 <code>|</code> 符号之前我们读入的test3用户公钥内容</li>
<li>最后面加上我们要create的用户名称</li>
</ul>
<p>这个命令执行完之后，管理员就把test3用户加入到了gerrit用户组中，并且设置了他的全称，邮件以及公钥文件，是不是一步到位，非常方便？？</p>
<p>这里我们回过头来，在管理员首次登陆web页面进行修改配置的时候，我们说过，管理员的邮箱可以通过命令行来设置，是的，同样通过ssh命令行：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ ssh gerrit gerrit <span class="built_in">set</span>-account --add-email admin@microwu.com admin</span><br></pre></td></tr></table></figure>
<p>这个命令就表示为我们的<code>admin</code>用户添加email<code>admin@microwu.com</code>。执行完这个命令，再回到web界面上的用户设置界面，看看是不是管理员的email已经被设置好了？？</p>
<h2 id="修改用户所在组"><a href="#修改用户所在组" class="headerlink" title="修改用户所在组"></a>修改用户所在组</h2><p>接下来我们看一下怎样修改test3用户所在的组吧。我们知道他已经出在<code>Anonymous Users</code>组中了，那我们想要新建一个组，就叫<code>test_user</code>吧，我们来看一下</p>
<p align="center"><br>  <img src="http://7xqppk.com1.z0.glb.clouddn.com/20170118/16.png" width="800"><br></p>

<p>我们在gerrit页面的顶部，点击People –&gt; list， 看一下默认的两个分组，<code>Administrator</code>和<code>Non-interactive Users</code>，这两个分组我们都能从字面上理解是什么意思。我们注意到<code>Anonymous Users</code>这个分组并没有显示在页面，因为它是匿名的嘛，所有的用户自动添加到这个分组中了。</p>
<p align="center"><br>  <img src="http://7xqppk.com1.z0.glb.clouddn.com/20170118/17.png" width="800"><br></p>

<p>选择<code>Create New Group</code>，输入我们要添加的新的分组 <code>test_user</code></p>
<p align="center"><br>  <img src="http://7xqppk.com1.z0.glb.clouddn.com/20170118/18.png" width="800"><br></p>

<p>新的分组中，我们看到管理员的账号被自动添加了进来</p>
<p align="center"><br>  <img src="http://7xqppk.com1.z0.glb.clouddn.com/20170118/19.png" width="800"><br></p>

<p>我们在<code>Add</code>搜索栏中输入test，就会自动显示出来管理员之前在命令行中创建的test3用户，看到full-name和email了吧，都已经添加完成了！<br>test3用户已经添加到了test_user分组中了。</p>
<h2 id="新建和修改项目"><a href="#新建和修改项目" class="headerlink" title="新建和修改项目"></a>新建和修改项目</h2><p>用同样的方法，我们来新建一个项目吧</p>
<p align="center"><br>  <img src="http://7xqppk.com1.z0.glb.clouddn.com/20170118/20.png" width="800"><br></p>

<p>点击Project，然后Create New Project， 创建一个名为<code>test2</code>的项目吧。</p>
<p align="center"><br>  <img src="http://7xqppk.com1.z0.glb.clouddn.com/20170118/21.png" width="800"><br></p>

<p>可以通过点击project名称，进入到工程的详细设置界面。</p>
<p align="center"><br>  <img src="http://7xqppk.com1.z0.glb.clouddn.com/20170118/22.png" width="800"><br></p>

<p>点击顶部菜单栏中的<code>Access</code>，来设置这个项目的权限吧。<br>我们可以看到这个项目已经有了个默认的继承自<code>All-Projects</code>的权限，关于默认的权限这里不做多的介绍，想要深入学习的同学可以点击进去看一下。</p>
<p>修改权限的时候慎重，<font color="red">不要直接修改<code>All-Projects</code>组的权限</font>，因为这个是所有项目的依赖权限组，修改了以后，所有的项目权限都会跟着发生变化。</p>
<p align="center"><br>  <img src="http://7xqppk.com1.z0.glb.clouddn.com/20170118/23.png" width="800"><br></p>

<p>我们点击<code>Edit</code>按钮来修改这个项目的权限</p>
<p align="center"><br>  <img src="http://7xqppk.com1.z0.glb.clouddn.com/20170118/24.png" width="800"><br></p>

<p>我们把<code>Reference</code>改成<code>refs/*</code>，表示所有的refs下的分支<br>然后选择<code>read</code>项目</p>
<p align="center"><br>  <img src="http://7xqppk.com1.z0.glb.clouddn.com/20170118/25.png" width="800"><br></p>

<p>接着筛选不同的分组，并且赋予不同的权限。</p>
<ul>
<li>我们把<code>Anonymous Users</code>分组中的用户设置为<code>DENY</code></li>
<li>把我们刚建立好的，并且添加了test3用户的<code>test_user</code>分组权限设置为<code>ALLOW</code></li>
</ul>
<p>这样，当前的工程就只能被<code>test_user</code>组内的用户所访问，其他组的用户均无法访问了！</p>
<h2 id="test3用户clone工程"><a href="#test3用户clone工程" class="headerlink" title="test3用户clone工程"></a>test3用户clone工程</h2><p>接下来我们来到test3用户的电脑上，下拉刚刚创建的<code>test2</code>工程</p>
<p align="center"><br>  <img src="http://7xqppk.com1.z0.glb.clouddn.com/20170118/26.png" width="500"><br></p>

<p>在命令行执行下面的命令，就可以把test2工程给clone下来了</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ git <span class="built_in">clone</span> ssh://<span class="built_in">test</span>3@192.168.1.100:29418/<span class="built_in">test</span>2.git</span><br></pre></td></tr></table></figure>
<p>对比下，会发现我们的目录中多了一个名为test2的文件夹，这个就是我们的工程了！</p>
<p align="center"><br>  <img src="http://7xqppk.com1.z0.glb.clouddn.com/20170118/27.png" width="500"><br></p>

<p>注意如果从ssh方式clone下来的工程，里面是自带了hooks文件夹的，这个文件夹很重要！！如果不是用<code>ssh://</code>方式克隆下来的，还没有这个文件夹，需要我们自己<code>mkdir</code></p>
<p>我们直接新建一个test.md文件，来尝试着往远程提交。</p>
<font color="red">注意： 前方会出现很多错误，耐心一步一步来</font>

<h2 id="提交"><a href="#提交" class="headerlink" title="提交"></a>提交</h2><p>首先我们通过下面两个命令首先commit到本地仓库：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ git add test.md</span><br><span class="line">$ git commit</span><br></pre></td></tr></table></figure>
<p align="center"><br>  <img src="http://7xqppk.com1.z0.glb.clouddn.com/20170118/28.png" width="500"><br></p>

<p>在commit的时候，发现提交者的名称和email都是错误的，我们需要先配置成我们当前的test3用户，以及对应的email</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ git config user.name <span class="built_in">test</span>3</span><br><span class="line">$ git config user.email <span class="built_in">test</span>3@microwu.com</span><br></pre></td></tr></table></figure>
<p align="center"><br>  <img src="http://7xqppk.com1.z0.glb.clouddn.com/20170118/30.png" width="500"><br></p>

<p>通过<code>git config --list</code>来查看一下当前git仓库的配置，发现已经把用户名和密码正确设置了。</p>
<p>接下来我们继续<code>git commit</code>来提交到本地</p>
<p align="center"><br>  <img src="http://7xqppk.com1.z0.glb.clouddn.com/20170118/29.png" width="500"><br></p>

<p>我们把这次提交命名为<code>commit_1</code>，然后我们通过<code>git push</code>命令来推送</p>
<p align="center"><br>  <img src="http://7xqppk.com1.z0.glb.clouddn.com/20170118/31.png" width="500"><br></p>

<p>发现推送失败了，提示的错误是：</p>
<blockquote>
<p>You are not allowed to perform this operation<br>[remote rejected] master -&gt; master (prohibited by Gerrit)</p>
</blockquote>
<p>Gerrit拒绝了我们直接提交到master的推送！ </p>
<p>这就是我们在文章开头提到的问题，我们需要push到<code>refs/for/master</code>那条线上！！</p>
<p>那怎么办呢？？<br>我们在命令行写入下面的命令：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ git config remote.origin.push refs/heads/*:refs/<span class="keyword">for</span>/*</span><br></pre></td></tr></table></figure>
<p>这行命令的意思是，当执行<code>push</code>命令时，将会推送到<code>refs/for/当前head所在的分支</code>上。</p>
<p align="center"><br>  <img src="http://7xqppk.com1.z0.glb.clouddn.com/20170118/32.png" width="600"><br></p>

<p>我们设置了push命令之后，重新进行push，结果又报错了。。<br>这次的错误是：</p>
<blockquote>
<p>missing Change-Id in commit message footer</p>
</blockquote>
<p>这个是提到的第2个问题，commit一定要有<code>Change-Id</code><br>然后我们看到了命令行中给了我们提示，我们可以从hooks文件中拷贝commit-msg文件下来，这样commit时，会自动帮我们生成<code>Change-Id</code>.</p>
<p align="center"><br>  <img src="http://7xqppk.com1.z0.glb.clouddn.com/20170118/33.png" width="600"><br></p>

<p>我们可以看一下 <code>git rev-parse --git-dir</code>就是指向的当前git配置的文件，就是<code>.git</code>文件夹<br>所以我们直接用scp命令从gerrit服务器上拉取当前用户的hooks文件。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ scp -p -P 29418 <span class="built_in">test</span>3@192.168.1.100:hooks/commit-msg .git/hooks/</span><br></pre></td></tr></table></figure>
<p>然后我们重新push发现一样的错误，因为我们还停留在上次commit，上次的commit是没有生成<code>Change-Id</code>的！</p>
<p align="center"><br>  <img src="http://7xqppk.com1.z0.glb.clouddn.com/20170118/34.png" width="500"><br></p>

<p>没有关系，我们回退一下，然后重新提交。<br>回退命令是先用<code>git log</code>找到上一次的commit id，  然后用<code>git reset --hard 找到的id</code>命令回退</p>
<p>这次我们终于提交成功了，可以看到提交到的分支是<code>refs/for/master</code></p>
<h2 id="管理员审查"><a href="#管理员审查" class="headerlink" title="管理员审查"></a>管理员审查</h2><p>接下来我们回到管理员的web页面，会发现，test3用户刚提交的那条已经在页面中了<br>点击顶部的<code>My --&gt; Watched Changes</code></p>
<p align="center"><br>  <img src="http://7xqppk.com1.z0.glb.clouddn.com/20170118/35.png" width="800"><br></p>

<p>因为之前我们已经监听了<code>All-Projects</code>，而test2工程又是默认继承自<code>All-Projects</code>的，所以我们就可以收到了，如果当前管理员没有监听<code>All-Projects</code>，就需要手动把<code>test2</code>项目加进来，否则是不会在<code>watched</code>页面看到这条推送提醒的。</p>
<p>与此同时，我们会收到来自gerrit@microwu.com发送来的邮件了：</p>
<p align="center"><br>  <img src="http://7xqppk.com1.z0.glb.clouddn.com/20170118/41.png" width="500"><br></p>

<h3 id="事件处理"><a href="#事件处理" class="headerlink" title="事件处理"></a>事件处理</h3><p>我们通过点击commit_1可以进入到当前事件的详情页面：</p>
<p align="center"><br>  <img src="http://7xqppk.com1.z0.glb.clouddn.com/20170118/36.png" width="800"><br></p>

<p>可以在页面中看到我们生成的<code>Change-Id</code>，以及我们新添加的文件<code>test.md</code>，点击以后可以看到每个文件的详情。<br>注意屏幕中间的两个按钮：</p>
<ul>
<li>Reply 表示对这次事件的回应，里面可以有5个选项，表示当前审查人员对这个事件的打分：-2，-1，0，+1，+2， +2表示直接同意，1表示我同意了，需要别的人员来一起审核</li>
<li>Code-Review+2 相当于直接打+2分</li>
</ul>
<p align="center"><br>  <img src="http://7xqppk.com1.z0.glb.clouddn.com/20170118/38.png" width="800"><br></p>

<p>我们还可以通过点击右边的小人，来添加新的审核人员</p>
<p align="center"><br>  <img src="http://7xqppk.com1.z0.glb.clouddn.com/20170118/37.png" width="800"><br></p>

<p>reply之后，如果分数够了2分，就可以直接submit到主线上去了</p>
<p align="center"><br>  <img src="http://7xqppk.com1.z0.glb.clouddn.com/20170118/39.png" width="800"><br></p>

<p>合并了之后，可以在 <code>My --&gt; Changes</code> 中看到我们的审核历史</p>
<p align="center"><br>  <img src="http://7xqppk.com1.z0.glb.clouddn.com/20170118/40.png" width="800"><br></p>

<p>到这里，一个完整的从普通项目成员提交，到代码审核人员检查的全过程，就结束了。</p>
<h1 id="SourceTree"><a href="#SourceTree" class="headerlink" title="SourceTree"></a>SourceTree</h1><p>SourceTree是git的可视化工具，也是比较流行的git工具，通过sourceTree我们一样可以commit，push等，而且更方便直观地看到项目的历史等等。</p>
<p>在上面的示例中，我们都是通过命令行来完成git的相关操作的，那通过soureTree，我们同样需要注意那两点：</p>
<ol>
<li>commit时要有<code>Change-Id</code></li>
<li>push一定要到<code>refs/for/master</code>分支上</li>
</ol>
<p>这里还需要额外注意一点：</p>
<ul>
<li>如果我们是通过soureTree工具clone项目，而不是通过<code>ssh://</code>方式来clone，那么工程中的.git文件夹中是没有hooks文件夹的，需要我们手动去文件夹中创建</li>
</ul>
<p>我们在管理员的视角从gerrit服务器上拉取之前的test2工程吧：</p>
<p align="center"><br>  <img src="http://7xqppk.com1.z0.glb.clouddn.com/20170118/42.png" width="500"><br></p>

<p align="center"><br>  <img src="http://7xqppk.com1.z0.glb.clouddn.com/20170118/43.png" width="500"><br></p>

<ul>
<li>Source URL中填入gerrit:test2.git。 因为我们之前已经在<code>.ssh/config</code>文件中设置好了名为gerrit的HOST所以这里就可以简写了</li>
</ul>
<p align="center"><br>  <img src="http://7xqppk.com1.z0.glb.clouddn.com/20170118/44.png" width="800"><br></p>

<p>可以看到test3用户提交的commit_1，因为已经通过审核了，所以，就合并到master中了</p>
<p>我们到当前的目录中，看一下.git文件夹，确实是没有hooks文件夹的</p>
<p align="center"><br>  <img src="http://7xqppk.com1.z0.glb.clouddn.com/20170118/45.png" width="500"><br></p>

<p>我们通过<code>scp gerrit:hooks/commit-msg hooks/</code>命令来拉取commit-msg文件</p>
<p align="center"><br>  <img src="http://7xqppk.com1.z0.glb.clouddn.com/20170118/46.png" width="500"><br></p>

<p>同时通过<code>git config remote.origin.push refs/heads/*:refs/for/*</code>命令来设置push命令</p>
<h2 id="设置自定义push"><a href="#设置自定义push" class="headerlink" title="设置自定义push"></a>设置自定义push</h2><p>虽然我们设置好了push命令到远程的<code>refs/for/*</code>目录，但是如果我们直接用SourceTree中的push功能，我们会发现直接给我们在远程新建了一个<code>refs/for/*</code>分支，而且gerrit也没有审核事件触发，这是因为sourceTree的push应该是有它自己的一些配置，所以这里我们需要自定义push事件，来完成将代码推送到正确的分支上。</p>
<p align="center"><br>  <img src="http://7xqppk.com1.z0.glb.clouddn.com/20170118/47.png" width="500"><br></p>

<p>我们进入SourceTree的配置页面</p>
<p align="center"><br>  <img src="http://7xqppk.com1.z0.glb.clouddn.com/20170118/48.png" width="500"><br></p>


<p>点击<code>Custom Actions</code>，然后输入命令的名字： push to gerrit</p>
<ul>
<li>Script to run： 指的是要执行的文件，我们这里把git的可执行文件目录放进来，如果是windows请自行找到该目录</li>
<li>Parameters 就直接写入<code>push</code>，表示执行的是push命令</li>
</ul>
<p align="center"><br>  <img src="http://7xqppk.com1.z0.glb.clouddn.com/20170118/49.png" width="500"><br></p>

<p>最后当我们要通过推送到gerrit服务器时，在当前的分支上，右键，然后点击<code>Custom Actions</code>，再选择我们刚创建的<code>push to gerrit</code>动作，就实现了推送到gerrit服务器的功能！！</p>
<p>好了，到这里，关于gerrit的所有内容都介绍完了！！！</p>
<h1 id="致谢-amp-参考文文章"><a href="#致谢-amp-参考文文章" class="headerlink" title="致谢&amp;参考文文章"></a>致谢&amp;参考文文章</h1><p>这里特别感谢<a href="http://blog.csdn.net/benkaoya/article/details/8680886" target="_blank" rel="external">烤鸭的gerrit使用总结</a>，基本上我都是在这篇blog上一点一点摸索出来的，不过作者写的总结时间有点远了，所以我在他的上面做了一些总结和新增。</p>
<p>其余参考文件：</p>
<ul>
<li><a href="http://zengestudy.blog.51cto.com/1702365/1772019" target="_blank" rel="external">Gerrit用户项目权限管理</a></li>
<li><a href="http://zengestudy.blog.51cto.com/1702365/1771762" target="_blank" rel="external">Gerrit配置–用户配置</a></li>
<li><a href="http://blog.csdn.net/csfreebird/article/details/7604560" target="_blank" rel="external">Gerrit管理帐号</a></li>
<li><a href="http://stackoverflow.com/questions/9917645/push-to-gerrit-using-sourcetree" target="_blank" rel="external">Push to gerrit using SourceTree</a></li>
<li><a href="http://www.cnblogs.com/hyb1/archive/2013/04/25/3041989.html" target="_blank" rel="external">Gerrit使用说明</a></li>
<li><a href="http://stackoverflow.com/questions/31609988/gerrit-email-notification-for-push-to-master-branch" target="_blank" rel="external">Gerrit email notification for push to master branch</a> </li>
</ul>
  
	</div>
		<footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/Git/">Git</a>
</div>


  <div class="article-tags">
  
  <span></span> <a href="/tags/git/">git</a><a href="/tags/Linux/">Linux</a><a href="/tags/gerrit/">gerrit</a>
  </div>

</div>



	<div class="article-share" id="share">
	
	  <div data-url="http://lipeng1667.github.io/2017/01/18/gerrit-guide/" data-title="【Gerrit】Gerrit工作流程及使用手册 | KaKa&#39;s blog" data-tsina="undefined" class="share clearfix">
	  </div>
	
	</div>


</footer>

   	       
	</article>
	
<nav class="article-nav clearfix">
 
 <div class="prev" >
 <a href="/2017/02/27/promise-of-js/" title="【WEB开发】JS的异步执行操作--Promise用法">
  <strong>上一篇：</strong><br/>
  <span>
  【WEB开发】JS的异步执行操作--Promise用法</span>
</a>
</div>


<div class="next">
<a href="/2017/01/17/build-gerrit-with-nginx/"  title="【Gerrit】Linux + Gerrit + Nginx + gitweb安装全过程">
 <strong>下一篇：</strong><br/> 
 <span>【Gerrit】Linux + Gerrit + Nginx + gitweb安装全过程
</span>
</a>
</div>

</nav>

	
<section id="comments" class="comment">
  <div id="disqus_thread">
   <!-- <noscript>Please enable JavaScript to view the <a
href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript> -->
  </div>
</section>


</div>  
      <div class="openaside"><a class="navbutton" href="#" title="Show Sidebar"></a></div>

  <div id="toc" class="toc-aside">
  <strong class="toc-title">Contents</strong>
 
 <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#gerrit工作流程"><span class="toc-number">1.</span> <span class="toc-text">gerrit工作流程</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#管理员配置"><span class="toc-number">2.</span> <span class="toc-text">管理员配置</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#profile"><span class="toc-number">2.1.</span> <span class="toc-text">profile</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Preferences"><span class="toc-number">2.2.</span> <span class="toc-text">Preferences</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Watched-Projects"><span class="toc-number">2.3.</span> <span class="toc-text">Watched Projects</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Contact-Information"><span class="toc-number">2.4.</span> <span class="toc-text">Contact Information</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SSH-Public-Keys"><span class="toc-number">2.5.</span> <span class="toc-text">SSH Public Keys</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#生成公私钥对"><span class="toc-number">2.5.1.</span> <span class="toc-text">生成公私钥对</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#找到公钥文件"><span class="toc-number">2.5.2.</span> <span class="toc-text">找到公钥文件</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Groups"><span class="toc-number">2.6.</span> <span class="toc-text">Groups</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#示例"><span class="toc-number">3.</span> <span class="toc-text">示例</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#管理员设置SSH"><span class="toc-number">3.1.</span> <span class="toc-text">管理员设置SSH</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#添加普通成员"><span class="toc-number">3.2.</span> <span class="toc-text">添加普通成员</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#修改用户所在组"><span class="toc-number">3.3.</span> <span class="toc-text">修改用户所在组</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#新建和修改项目"><span class="toc-number">3.4.</span> <span class="toc-text">新建和修改项目</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#test3用户clone工程"><span class="toc-number">3.5.</span> <span class="toc-text">test3用户clone工程</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#提交"><span class="toc-number">3.6.</span> <span class="toc-text">提交</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#管理员审查"><span class="toc-number">3.7.</span> <span class="toc-text">管理员审查</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#事件处理"><span class="toc-number">3.7.1.</span> <span class="toc-text">事件处理</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#SourceTree"><span class="toc-number">4.</span> <span class="toc-text">SourceTree</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#设置自定义push"><span class="toc-number">4.1.</span> <span class="toc-text">设置自定义push</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#致谢-amp-参考文文章"><span class="toc-number">5.</span> <span class="toc-text">致谢&参考文文章</span></a></li></ol>
 
  </div>

<div id="asidepart">
<div class="closeaside"><a class="closebutton" href="#" title="Hide Sidebar"></a></div>
<aside class="clearfix">

  
<div class="categorieslist">
	<p class="asidetitle">Categories</p>
		<ul>
		
		  
			<li><a href="/categories/android/" title="Android">Android<sup>11</sup></a></li>
		  
		
		  
			<li><a href="/categories/Blog/" title="Blog">Blog<sup>2</sup></a></li>
		  
		
		  
			<li><a href="/categories/Git/" title="Git">Git<sup>2</sup></a></li>
		  
		
		  
			<li><a href="/categories/LAMP/" title="LAMP">LAMP<sup>5</sup></a></li>
		  
		
		  
			<li><a href="/categories/Linux/" title="Linux">Linux<sup>3</sup></a></li>
		  
		
		  
			<li><a href="/categories/Python/" title="Python">Python<sup>2</sup></a></li>
		  
		
		  
			<li><a href="/categories/WEB开发/" title="WEB开发">WEB开发<sup>3</sup></a></li>
		  
		
		  
			<li><a href="/categories/iOS/" title="iOS">iOS<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/个人随想/" title="个人随想">个人随想<sup>6</sup></a></li>
		  
		
		  
			<li><a href="/categories/Database/" title="数据库">数据库<sup>1</sup></a></li>
		  
		
		</ul>
</div>


  
<div class="tagslist">
	<p class="asidetitle">Tags</p>
		<ul class="clearfix">
		
			
				<li><a href="/tags/Android/" title="Android">Android<sup>6</sup></a></li>
			
		
			
				<li><a href="/tags/Linux/" title="Linux">Linux<sup>6</sup></a></li>
			
		
			
				<li><a href="/tags/webview/" title="webview">webview<sup>3</sup></a></li>
			
		
			
				<li><a href="/tags/JavaScript/" title="JavaScript">JavaScript<sup>3</sup></a></li>
			
		
			
				<li><a href="/tags/gerrit/" title="gerrit">gerrit<sup>2</sup></a></li>
			
		
			
				<li><a href="/tags/python/" title="python">python<sup>2</sup></a></li>
			
		
			
				<li><a href="/tags/php/" title="php">php<sup>2</sup></a></li>
			
		
			
				<li><a href="/tags/Mac/" title="Mac">Mac<sup>2</sup></a></li>
			
		
			
				<li><a href="/tags/Parallels/" title="Parallels">Parallels<sup>2</sup></a></li>
			
		
			
				<li><a href="/tags/虚拟机/" title="虚拟机">虚拟机<sup>2</sup></a></li>
			
		
			
				<li><a href="/tags/git/" title="git">git<sup>2</sup></a></li>
			
		
			
				<li><a href="/tags/AndroidStudio/" title="AndroidStudio">AndroidStudio<sup>2</sup></a></li>
			
		
			
				<li><a href="/tags/RedHat6-5/" title="RedHat6.5">RedHat6.5<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/oracle/" title="oracle">oracle<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/redhat/" title="redhat">redhat<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/network/" title="network">network<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/linux-apache-mysql-php/" title="linux, apache, mysql, php">linux, apache, mysql, php<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/Apache/" title="Apache">Apache<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/nginx/" title="nginx">nginx<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/mysql-php/" title="mysql, php">mysql, php<sup>1</sup></a></li>
			
		
		</ul>
</div>


</aside>
</div>
    </div>
    <footer><div id="footer" >
	
	<div class="line">
		<span></span>
		<div class="author"></div>
	</div>
	
	
	<section class="info">
		<p> Hello ,I&#39;m Michael Lee. Life is for sharing! <br/>
			伪文青，伪球迷，却绝不做虚伪的人; 爱编程，爱皇马，好好学习天天向上!</p>
	</section>
	 
	<div class="social-font" class="clearfix">
		
		<a href="http://weibo.com/331578923" target="_blank" class="icon-weibo" title="微博"></a>
		
		
		<a href="https://github.com/lipeng1667" target="_blank" class="icon-github" title="github"></a>
		
		
		<a href="http://stackoverflow.com/users/3822574" target="_blank" class="icon-stack-overflow" title="stackoverflow"></a>
		
		
		<a href="https://twitter.com/Leepeng1667" target="_blank" class="icon-twitter" title="twitter"></a>
		
		
		<a href="https://www.facebook.com/peng.li.5011516" target="_blank" class="icon-facebook" title="facebook"></a>
		
		
		
		<a href="https://www.douban.com/people/58389742" target="_blank" class="icon-douban" title="豆瓣"></a>
		
		
		
		
		<a href="mailto:lipeng1667@gmail.com" target="_blank" class="icon-email" title="Email Me"></a>
		
	</div>
			
		

        <span class="busuanzi_container_site_pv">
          本站总访问量<span id="busuanzi_value_site_pv"></span>次
        </span>

		<p class="copyright">
		Powered by <a href="http://hexo.io" target="_blank" title="hexo">hexo</a> and Theme by <a href="https://github.com/wuchong/jacman" target="_blank" title="Jacman">Jacman</a> © 2017 
		
		<a href="/about" target="_blank" title="Michael Lee">Michael Lee</a>
		
		
		</p>
</div>
</footer>
    <script src="/js/jquery-2.0.3.min.js"></script>
<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>
<script src="/js/jquery.qrcode-0.12.0.min.js"></script>

<script type="text/javascript">
$(document).ready(function(){ 
  $('.navbar').click(function(){
    $('header nav').toggleClass('shownav');
  });
  var myWidth = 0;
  function getSize(){
    if( typeof( window.innerWidth ) == 'number' ) {
      myWidth = window.innerWidth;
    } else if( document.documentElement && document.documentElement.clientWidth) {
      myWidth = document.documentElement.clientWidth;
    };
  };
  var m = $('#main'),
      a = $('#asidepart'),
      c = $('.closeaside'),
      o = $('.openaside');
  c.click(function(){
    a.addClass('fadeOut').css('display', 'none');
    o.css('display', 'block').addClass('fadeIn');
    m.addClass('moveMain');
  });
  o.click(function(){
    o.css('display', 'none').removeClass('beforeFadeIn');
    a.css('display', 'block').removeClass('fadeOut').addClass('fadeIn');      
    m.removeClass('moveMain');
  });
  $(window).scroll(function(){
    o.css("top",Math.max(80,260-$(this).scrollTop()));
  });
  
  $(window).resize(function(){
    getSize(); 
    if (myWidth >= 1024) {
      $('header nav').removeClass('shownav');
    }else{
      m.removeClass('moveMain');
      a.css('display', 'block').removeClass('fadeOut');
      o.css('display', 'none');
      
      $('#toc.toc-aside').css('display', 'none');
        
    }
  });
});
</script>

<script type="text/javascript">
$(document).ready(function(){ 
  var ai = $('.article-content>iframe'),
      ae = $('.article-content>embed'),
      t  = $('#toc'),
      ta = $('#toc.toc-aside'),
      o  = $('.openaside'),
      c  = $('.closeaside');
  if(ai.length>0){
    ai.wrap('<div class="video-container" />');
  };
  if(ae.length>0){
   ae.wrap('<div class="video-container" />');
  };
  c.click(function(){
    ta.css('display', 'block').addClass('fadeIn');
  });
  o.click(function(){
    ta.css('display', 'none');
  });
  $(window).scroll(function(){
    ta.css("top",Math.max(140,320-$(this).scrollTop()));
  });
});
</script>


<script type="text/javascript">
$(document).ready(function(){ 
  var $this = $('.share'),
      url = $this.attr('data-url'),
      encodedUrl = encodeURIComponent(url),
      title = $this.attr('data-title'),
      tsina = $this.attr('data-tsina'),
      description = $this.attr('description');
  var html = [
  '<div class="hoverqrcode clearfix"></div>',
  '<a class="overlay" id="qrcode"></a>',
  '<a href="https://www.facebook.com/sharer.php?u=' + encodedUrl + '" class="article-share-facebook" target="_blank" title="Facebook"></a>',
  '<a href="https://twitter.com/intent/tweet?url=' + encodedUrl + '" class="article-share-twitter" target="_blank" title="Twitter"></a>',
  '<a href="#qrcode" class="article-share-qrcode" title="微信"></a>',
  '<a href="http://widget.renren.com/dialog/share?resourceUrl=' + encodedUrl + '&srcUrl=' + encodedUrl + '&title=' + title +'" class="article-share-renren" target="_blank" title="人人"></a>',
  '<a href="http://service.weibo.com/share/share.php?title='+title+'&url='+encodedUrl +'&ralateUid='+ tsina +'&searchPic=true&style=number' +'" class="article-share-weibo" target="_blank" title="微博"></a>',
  '<span title="Share to"></span>'
  ].join('');
  $this.append(html);

  $('.hoverqrcode').hide();

  var myWidth = 0;
  function updatehoverqrcode(){
    if( typeof( window.innerWidth ) == 'number' ) {
      myWidth = window.innerWidth;
    } else if( document.documentElement && document.documentElement.clientWidth) {
      myWidth = document.documentElement.clientWidth;
    };
    var qrsize = myWidth > 1024 ? 200:100;
    var options = {render: 'image', size: qrsize, fill: '#2ca6cb', text: url, radius: 0.5, quiet: 1};
    var p = $('.article-share-qrcode').position();
    $('.hoverqrcode').empty().css('width', qrsize).css('height', qrsize)
                          .css('left', p.left-qrsize/2+20).css('top', p.top-qrsize-10)
                          .qrcode(options);
  };
  $(window).resize(function(){
    $('.hoverqrcode').hide();
  });
  $('.article-share-qrcode').click(function(){
    updatehoverqrcode();
    $('.hoverqrcode').toggle();
  });
  $('.article-share-qrcode').hover(function(){}, function(){
      $('.hoverqrcode').hide();
  });
});   
</script>



<script type="text/javascript">

var disqus_shortname = 'lipeng1667';

(function(){
  var dsq = document.createElement('script');
  dsq.type = 'text/javascript';
  dsq.async = true;
  dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
  (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
}());
(function(){
  var dsq = document.createElement('script');
  dsq.type = 'text/javascript';
  dsq.async = true;
  dsq.src = '//' + disqus_shortname + '.disqus.com/count.js';
  (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
}());
</script>






<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
$(document).ready(function(){ 
  $('.article-content').each(function(i){
    $(this).find('img').each(function(){
      if ($(this).parent().hasClass('fancybox')) return;
      var alt = this.alt;
      if (alt) $(this).after('<span class="caption">' + alt + '</span>');
      $(this).wrap('<a href="' + this.src + '" title="' + alt + '" class="fancybox"></a>');
    });
    $(this).find('.fancybox').each(function(){
      $(this).attr('rel', 'article' + i);
    });
  });
  if($.fancybox){
    $('.fancybox').fancybox();
  }
}); 
</script>


<script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js">
</script>

<!-- Analytics Begin -->

<script type="text/javascript">
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');
ga('create', 'UA-73232459-1', 'null');  
ga('send', 'pageview');
</script>





<!-- Analytics End -->

<!-- Totop Begin -->

	<div id="totop">
	<a title="Back to Top"><img src="/img/scrollup.png"/></a>
	</div>
	<script src="/js/totop.js"></script>

<!-- Totop End -->

<!-- MathJax Begin -->
<!-- mathjax config similar to math.stackexchange -->


<!-- MathJax End -->

<!-- Tiny_search Begin -->

<!-- Tiny_search End -->

  </body>
</html>
